const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ChatPage-CSkd91X2.js","assets/vendor-DeShHRvC.js","assets/vendor-jspdf-CcCK2Zy6.js","assets/vendor-@react-oauth-Di4DNcpW.js","assets/http-VSpmzgsF.js","assets/vendor-matter-js-BjVipDty.js","assets/vendor-ogl-YOJCSol6.js","assets/vendor-motion-BfReZoSV.js","assets/vendor-gsap-CSqFbIEy.js","assets/ChatPage-DxCoNe63.css","assets/BlackMirrorPage-v7ZP0Qwx.js","assets/vendor-jspdf-autotable-C_IpTXQp.js","assets/BlackMirrorPage-Bqh_5FVf.css","assets/PremiumPage-D7jmUDgA.js","assets/PremiumPage-CBbKuuxq.css","assets/NotFoundPage-DqH19mUl.js","assets/NotFoundPage-DN7MyKA5.css","assets/VerifyEmailPage-7hBDg8h6.js","assets/VerifyEmailPage-ChfI-pJi.css","assets/ForgotPasswordPage-k-EvJHey.js","assets/ResetPasswordPage-BKDMyTgl.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,a,s)=>((t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s)(t,"symbol"!=typeof a?a+"":a,s);import{r as a,j as s,R as r,u as n,H as i,b as o,B as l,e as c,f as d,h as u,i as h}from"./vendor-DeShHRvC.js";import{_ as m}from"./vendor-jspdf-CcCK2Zy6.js";import{G as p}from"./vendor-@react-oauth-Di4DNcpW.js";import{a as g}from"./http-VSpmzgsF.js";import{M as y}from"./vendor-matter-js-BjVipDty.js";import{R as x,P as v,T as f,M as j}from"./vendor-ogl-YOJCSol6.js";import{m as b,A as N}from"./vendor-motion-BfReZoSV.js";import{g as C}from"./vendor-gsap-CSqFbIEy.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const w=()=>"undefined"!=typeof window&&"function"==typeof window.gtag,E=(e,t=!1)=>{((e,t={})=>{if(w())try{window.gtag("event",e,t)}catch(a){console.error("Error tracking event:",a)}else console.debug("GA not available, skipping event:",e,t)})("exception",{description:e,fatal:t})},S=a.createContext();function k({children:e}){const[t,r]=a.useState(!1),[n,i]=a.useState(null),o=a.useCallback(e=>{i(e),r(!0)},[]),l=a.useCallback(()=>{r(!1),i(null)},[]);return s.jsx(S.Provider,{value:{isTransitioning:t,nextPath:n,startTransition:o,endTransition:l},children:e})}function A(){const e=a.useContext(S);if(!e)throw new Error("usePageTransition must be used within PageTransitionProvider");return e}const T=g.create({baseURL:"/api",timeout:3e4,headers:{"Content-Type":"application/json"},withCredentials:!0});T.interceptors.request.use(e=>e,e=>Promise.reject(e)),T.interceptors.response.use(e=>e.data,e=>{const{response:t,code:a,message:s}=e;if(!t)return console.error("[API Error - No Response]",a,s),Promise.reject({type:"NETWORK_ERROR",code:a,message:"Network error. Please check your connection."});const{status:r,data:n}=t;switch(console.error(`[API Error] ${r}`,n),r){case 401:return window.dispatchEvent(new CustomEvent("auth:unauthorized",{detail:{message:"Session expired. Please log in again."}})),Promise.reject({type:"UNAUTHORIZED",status:401,message:"Session expired. Please log in again."});case 403:return Promise.reject({type:"FORBIDDEN",status:403,message:"You do not have permission to perform this action."});case 404:return Promise.reject({type:"NOT_FOUND",status:404,message:(null==n?void 0:n.message)||"Resource not found."});case 429:return Promise.reject({type:"RATE_LIMITED",status:429,message:"Too many requests. Please wait a moment and try again."});case 500:case 502:case 503:case 504:return Promise.reject({type:"SERVER_ERROR",status:r,message:"Server error. Please try again later."});default:return Promise.reject({type:"ERROR",status:r,message:(null==n?void 0:n.message)||"An error occurred. Please try again."})}});const I={login:async(e,t)=>{try{return await T.post("/login",{email:e,password:t})}catch(a){throw console.error("Login failed:",a),a}},signup:async(e,t,a)=>{try{return await T.post("/register",{email:e,password:t,username:a||e.split("@")[0]})}catch(s){throw console.error("Signup failed:",s),s}},refreshToken:async()=>{try{return await T.post("/auth/refresh")}catch(e){throw console.error("Token refresh failed:",e),I.logout(),e}},logout:async()=>{try{await T.post("/logout")}catch(e){console.error("Server logout failed:",e)}},getCurrentUser:async()=>{try{return(await T.get("/auth/me")).user}catch(e){throw console.error("Failed to fetch current user:",e),e}},updateProfile:async e=>{try{return await T.patch("/auth/me",e)}catch(t){throw console.error("Failed to update profile:",t),t}},changePassword:async(e,t)=>{try{return await T.post("/auth/change-password",{currentPassword:e,newPassword:t})}catch(a){throw console.error("Failed to change password:",a),a}},requestPasswordReset:async e=>{try{return await T.post("/auth/forgot-password",{email:e})}catch(t){throw console.error("Failed to request password reset:",t),t}},resetPassword:async(e,t)=>{try{return await T.post("/auth/reset-password",{token:e,newPassword:t})}catch(a){throw console.error("Failed to reset password:",a),a}},verifyEmail:async e=>{try{return await T.post("/auth/verify-email",{token:e})}catch(t){throw console.error("Failed to verify email:",t),t}}},M=a.createContext(),R={user:null,isAuthenticated:!1,isLoading:!0,isAuthenticating:!1,error:null,token:null,refreshToken:null},P="SET_LOADING",L="SET_AUTHENTICATING",_="LOGIN_SUCCESS",O="SIGNUP_SUCCESS",D="LOGOUT",F="SET_USER",G="SET_ERROR",U="CLEAR_ERROR",$="TOKEN_REFRESH";function z(e,t){switch(t.type){case P:return{...e,isLoading:t.payload};case L:return{...e,isAuthenticating:t.payload,error:null};case _:case O:return{...e,user:t.payload.user,isAuthenticated:!0,token:t.payload.token,refreshToken:t.payload.refreshToken,isAuthenticating:!1,error:null,isLoading:!1};case D:return{...e,user:null,isAuthenticated:!1,token:null,refreshToken:null,error:null};case F:return{...e,user:t.payload,isAuthenticated:!!t.payload,isLoading:!1};case G:return{...e,error:t.payload,isAuthenticating:!1};case U:return{...e,error:null};case $:return{...e,token:t.payload.token,refreshToken:t.payload.refreshToken};default:return e}}function B({children:e}){const[t,r]=a.useReducer(z,R);a.useEffect(()=>{(async()=>{try{r({type:P,payload:!0});const e=await I.getCurrentUser();if(!e||!e.id)throw new Error("Invalid user data received");r({type:F,payload:e})}catch(e){console.error("Failed to restore auth:",e),I.logout(),r({type:D})}finally{r({type:P,payload:!1})}})()},[]);const n=a.useCallback(async(e,t)=>{r({type:L,payload:!0});try{const a=await I.login(e,t);if(!a.user||!a.user.id)throw new Error("Invalid user data received from login");return r({type:_,payload:a}),a.user}catch(a){throw r({type:G,payload:a.message||"Login failed"}),a}},[]),i=a.useCallback(async(e,t,a)=>{r({type:L,payload:!0});try{const s=await I.signup(e,t,a);if(!s.user||!s.user.id)throw new Error("Invalid user data received from signup");return r({type:O,payload:s}),s.user}catch(s){throw r({type:G,payload:s.message||"Signup failed"}),s}},[]),o=a.useCallback(()=>{I.logout(),r({type:D})},[]),l=a.useCallback(async e=>{try{const t=await I.updateProfile(e);return r({type:F,payload:t}),t}catch(t){throw r({type:G,payload:t.message||"Profile update failed"}),t}},[]),c=a.useCallback(()=>{r({type:U})},[]),d=a.useCallback(e=>{r({type:F,payload:e})},[]),u={user:t.user,isAuthenticated:t.isAuthenticated,isLoading:t.isLoading,isAuthenticating:t.isAuthenticating,error:t.error,token:t.token,login:n,signup:i,logout:o,updateProfile:l,clearError:c,setUser:d};return s.jsx(M.Provider,{value:u,children:e})}function V(){const e=a.useContext(M);if(!e)throw new Error("useAuth must be used within AuthProvider");return{user:e.user,isAuthenticated:e.isAuthenticated,isLoading:e.isLoading,isAuthenticating:e.isAuthenticating,error:e.error,token:e.token,login:e.login,signup:e.signup,logout:e.logout,updateProfile:e.updateProfile,clearError:e.clearError,setUser:e.setUser}}const q=a.createContext(null),W="undefined"!=typeof window&&window.innerWidth<768,H={sidebarOpen:!W,isMobileView:W,modalStack:[],notificationQueue:[],selectedTab:"chat"},Y="TOGGLE_SIDEBAR",J="SET_SIDEBAR_OPEN",X="SET_MOBILE_VIEW",Q="OPEN_MODAL",Z="CLOSE_MODAL",K="CLOSE_ALL_MODALS",ee="UPDATE_MODAL_DATA",te="ADD_NOTIFICATION",ae="REMOVE_NOTIFICATION",se="SET_SELECTED_TAB";function re(e,t){switch(t.type){case Y:return{...e,sidebarOpen:!e.sidebarOpen};case J:return{...e,sidebarOpen:t.payload};case X:return{...e,isMobileView:t.payload};case Q:return e.modalStack.find(e=>e.type===t.payload.type)?{...e,modalStack:e.modalStack.map(e=>e.type===t.payload.type?{...e,data:t.payload.data||{}}:e)}:{...e,modalStack:[...e.modalStack,{id:t.payload.id,type:t.payload.type,isOpen:!0,data:t.payload.data||{}}]};case Z:return{...e,modalStack:e.modalStack.filter(e=>e.id!==t.payload)};case K:return{...e,modalStack:[]};case ee:return{...e,modalStack:e.modalStack.map(e=>e.id===t.payload.id?{...e,data:{...e.data,...t.payload.data}}:e)};case te:return{...e,notificationQueue:[...e.notificationQueue,{id:t.payload.id,message:t.payload.message,type:t.payload.type||"info",duration:t.payload.duration||3e3}]};case ae:return{...e,notificationQueue:e.notificationQueue.filter(e=>e.id!==t.payload)};case se:return{...e,selectedTab:t.payload};default:return e}}function ne({children:e}){const[t,r]=a.useReducer(re,H),[n,i]=a.useState(!1);a.useEffect(()=>{i(!0)},[]);const o={...t,isInitialized:n,toggleSidebar:a.useCallback(()=>{r({type:Y})},[]),setSidebarOpen:a.useCallback(e=>{r({type:J,payload:e})},[]),setMobileView:a.useCallback(e=>{r({type:X,payload:e})},[]),openModal:a.useCallback((e,t,a)=>{const s=a||`${e}-${Date.now()}`;return r({type:Q,payload:{id:s,type:e,data:t}}),s},[]),closeModal:a.useCallback(e=>{r({type:Z,payload:e})},[]),closeAllModals:a.useCallback(()=>{r({type:K})},[]),updateModalData:a.useCallback((e,t)=>{r({type:ee,payload:{id:e,data:t}})},[]),addNotification:a.useCallback((e,t="info",a=3e3)=>{const s=`notification-${Date.now()}`;return r({type:te,payload:{id:s,message:e,type:t,duration:a}}),a>0&&setTimeout(()=>{r({type:ae,payload:s})},a),s},[]),removeNotification:a.useCallback(e=>{r({type:ae,payload:e})},[]),setSelectedTab:a.useCallback(e=>{r({type:se,payload:e})},[])};return n?s.jsx(q.Provider,{value:o,children:e}):s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%)",color:"#fff"},children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"⚡"}),s.jsx("div",{children:"Initializing..."})]})})}function ie(e){const t=a.useContext(q),s=a.useRef(0);if(!t)throw new Error("useModal must be used within UIProvider");const r=t.modalStack.find(t=>t.type===e),n=a.useCallback((a,r)=>{const n=Date.now();return n-s.current<500?(console.log("[useModal] Debounced rapid modal open attempt"),null):(s.current=n,t.openModal(e,a,r))},[t,e]),i=a.useCallback(()=>{r&&t.closeModal(r.id)},[t,r]),o=a.useCallback(e=>{r&&t.updateModalData(r.id,e)},[t,r]);return{isOpen:!!r,data:(null==r?void 0:r.data)||{},modalId:null==r?void 0:r.id,openModal:n,closeModal:i,updateData:o}}const oe=1200,le=70,ce=60,de=20,ue=180,he=(e,t=0,a=100)=>Math.min(Math.max(e,t),a),me=(e,t=3)=>parseFloat(e.toFixed(t)),pe=(e,t,a,s,r)=>me(s+(r-s)*(e-t)/(a-t)),ge=r.memo(({avatarUrl:e="",iconUrl:t="",grainUrl:r="",innerGradient:n,behindGlowEnabled:i=!0,behindGlowColor:o,behindGlowSize:l,className:c="",enableTilt:d=!0,enableMobileTilt:u=!1,mobileTiltSensitivity:h=5,miniAvatarUrl:m,name:p="Javi A. Torres",title:g="Software Engineer",handle:y="javicodes",status:x="Online",contactText:v="Contact",showUserInfo:f=!0,onContactClick:j,children:b})=>{const N=a.useRef(null),C=a.useRef(null),w=a.useRef(null),E=a.useRef(null),S=a.useMemo(()=>{if(!d)return null;let e=null,t=!1,a=0,s=0,r=0,n=0,i=0;let o=0;const l=(e,t)=>{const a=C.current,s=N.current;if(!a||!s)return;const r=a.clientWidth||1,n=a.clientHeight||1,i=he(100/r*e),o=he(100/n*t),l=i-50,c=o-50,d={"--pointer-x":`${i}%`,"--pointer-y":`${o}%`,"--background-x":`${pe(i,0,100,35,65)}%`,"--background-y":`${pe(o,0,100,35,65)}%`,"--pointer-from-center":`${he(Math.hypot(o-50,i-50)/50,0,1)}`,"--pointer-from-top":""+o/100,"--pointer-from-left":""+i/100,"--rotate-x":`${me(-l/5)}deg`,"--rotate-y":`${me(c/4)}deg`};for(const[u,h]of Object.entries(d))s.style.setProperty(u,h)},c=d=>{if(!t)return;0===a&&(a=d);const u=(d-a)/1e3;a=d;const h=d<o?.6:.14,m=1-Math.exp(-u/h);s+=(n-s)*m,r+=(i-r)*m,l(s,r);Math.abs(n-s)>.05||Math.abs(i-r)>.05||document.hasFocus()?e=requestAnimationFrame(c):(t=!1,a=0,e&&(cancelAnimationFrame(e),e=null))},u=()=>{t||(t=!0,a=0,e=requestAnimationFrame(c))};return{setImmediate(e,t){s=e,r=t,l(s,r)},setTarget(e,t){n=e,i=t,u()},toCenter(){const e=C.current;e&&this.setTarget(e.clientWidth/2,e.clientHeight/2)},beginInitial(e){o=performance.now()+e,u()},getCurrent:()=>({x:s,y:r,tx:n,ty:i}),cancel(){e&&cancelAnimationFrame(e),e=null,t=!1,a=0}}},[d]),k=(e,t)=>{const a=t.getBoundingClientRect();return{x:e.clientX-a.left,y:e.clientY-a.top}},A=a.useCallback(e=>{const t=C.current;if(!t||!S)return;const{x:a,y:s}=k(e,t);S.setTarget(a,s)},[S]),T=a.useCallback(e=>{const t=C.current;if(!t||!S)return;t.classList.add("active"),t.classList.add("entering"),w.current&&window.clearTimeout(w.current),w.current=window.setTimeout(()=>{t.classList.remove("entering")},ue);const{x:a,y:s}=k(e,t);S.setTarget(a,s)},[S]),I=a.useCallback(()=>{const e=C.current;if(!e||!S)return;S.toCenter();const t=()=>{const{x:a,y:s,tx:r,ty:n}=S.getCurrent();Math.hypot(r-a,n-s)<.6?(e.classList.remove("active"),E.current=null):E.current=requestAnimationFrame(t)};E.current&&cancelAnimationFrame(E.current),E.current=requestAnimationFrame(t)},[S]),M=a.useCallback(e=>{const t=C.current;if(!t||!S)return;const{beta:a,gamma:s}=e;if(null==a||null==s)return;const r=t.clientWidth/2,n=t.clientHeight/2,i=he(r+s*h,0,t.clientWidth),o=he(n+(a-de)*h,0,t.clientHeight);S.setTarget(i,o)},[S,h]);a.useEffect(()=>{if(!d||!S)return;const e=C.current;if(!e)return;const t=A,a=T,s=I,r=M;e.addEventListener("pointerenter",a),e.addEventListener("pointermove",t),e.addEventListener("pointerleave",s);const n=()=>{if(!u||"https:"!==location.protocol)return;const e=window.DeviceMotionEvent;e&&"function"==typeof e.requestPermission?e.requestPermission().then(e=>{"granted"===e&&window.addEventListener("deviceorientation",r)}).catch(console.error):window.addEventListener("deviceorientation",r)};e.addEventListener("click",n);const i=(e.clientWidth||0)-le,o=ce;return S.setImmediate(i,o),S.toCenter(),S.beginInitial(oe),()=>{e.removeEventListener("pointerenter",a),e.removeEventListener("pointermove",t),e.removeEventListener("pointerleave",s),e.removeEventListener("click",n),window.removeEventListener("deviceorientation",r),w.current&&window.clearTimeout(w.current),E.current&&cancelAnimationFrame(E.current),S.cancel(),e.classList.remove("entering")}},[d,u,S,A,T,I,M]);const R=a.useMemo(()=>({"--icon":t?`url(${t})`:"none","--grain":r?`url(${r})`:"none","--inner-gradient":null!=n?n:"linear-gradient(145deg,#60496e8c 0%,#71C4FF44 100%)","--behind-glow-color":null!=o?o:"rgba(125, 190, 255, 0.67)","--behind-glow-size":null!=l?l:"50%"}),[t,r,n,o,l]),P=a.useCallback(()=>{null==j||j()},[j]);return s.jsxs("div",{ref:N,className:`pc-card-wrapper ${c}`.trim(),style:R,children:[i&&s.jsx("div",{className:"pc-behind"}),s.jsx("div",{ref:C,className:"pc-card-shell",children:s.jsx("section",{className:"pc-card",children:s.jsxs("div",{className:"pc-inside",children:[s.jsx("div",{className:"pc-shine"}),s.jsx("div",{className:"pc-glare"}),b&&s.jsx("div",{className:"pc-children",children:b}),s.jsxs("div",{className:"pc-content pc-avatar-content",children:[e&&s.jsx("img",{className:"avatar",src:e,alt:`${p||"User"} avatar`,loading:"lazy",onError:e=>{e.target.style.display="none"}}),f&&s.jsxs("div",{className:"pc-user-info",children:[s.jsxs("div",{className:"pc-user-details",children:[(m||e)&&s.jsx("div",{className:"pc-mini-avatar",children:s.jsx("img",{src:m||e,alt:`${p||"User"} mini avatar`,loading:"lazy",onError:t=>{const a=t.target;a.style.opacity="0.5",e&&(a.src=e)}})}),s.jsxs("div",{className:"pc-user-text",children:[s.jsxs("div",{className:"pc-handle",children:["@",y]}),s.jsx("div",{className:"pc-status",children:x})]})]}),v&&j&&s.jsx("button",{className:"pc-contact-btn",onClick:P,style:{pointerEvents:"auto"},type:"button","aria-label":`Contact ${p||"user"}`,children:v})]})]}),s.jsx("div",{className:"pc-content",children:s.jsxs("div",{className:"pc-details",children:[s.jsx("h3",{children:p}),s.jsx("p",{children:g})]})})]})})})]})}),ye=({children:e,className:t="",speed:a=3,disabled:r=!1,shimmerWidth:n="200px"})=>s.jsx("span",{className:`shiny-text ${r?"shiny-text-disabled":""} ${t}`,style:{"--shimmer-speed":`${a}s`,"--shimmer-width":n},children:e}),xe=({className:e="",text:t="",highlightWords:r=[],highlightClass:n="highlighted",trigger:i="auto",backgroundColor:o="transparent",wireframes:l=!1,gravity:c=1,mouseConstraintStiffness:d=.2,fontSize:u="1rem"})=>{const h=a.useRef(null),m=a.useRef(null),p=a.useRef(null),[g,x]=a.useState(!1);a.useEffect(()=>{if(!m.current)return;const e=t.split(" ");for(;m.current.firstChild;)m.current.removeChild(m.current.firstChild);e.forEach((e,t)=>{t>0&&m.current.appendChild(document.createTextNode(" "));const a=document.createElement("span");a.className="word";r.some(t=>e.startsWith(t))&&a.classList.add(n),a.textContent=e,m.current.appendChild(a)})},[t,r,n]),a.useEffect(()=>{if("auto"!==i){if("scroll"===i&&h.current){const e=new IntersectionObserver(([t])=>{t.isIntersecting&&(x(!0),e.disconnect())},{threshold:.1});return e.observe(h.current),()=>e.disconnect()}}else x(!0)},[i]),a.useEffect(()=>{if(!g)return;const{Engine:e,Render:t,World:a,Bodies:s,Runner:r,Mouse:n,MouseConstraint:i}=y,u=h.current.getBoundingClientRect(),x=u.width,v=u.height;if(x<=0||v<=0)return;const f=e.create();f.world.gravity.y=c;const j=t.create({element:p.current,engine:f,options:{width:x,height:v,background:o,wireframes:l}}),b={isStatic:!0,render:{fillStyle:"transparent"}},N=s.rectangle(x/2,v+25,x,50,b),C=s.rectangle(-25,v/2,50,v,b),w=s.rectangle(x+25,v/2,50,v,b),E=s.rectangle(x/2,-25,x,50,b),S=[...m.current.querySelectorAll(".word")].map(e=>{const t=e.getBoundingClientRect(),a=t.left-u.left+t.width/2,r=t.top-u.top+t.height/2,n=s.rectangle(a,r,t.width,t.height,{render:{fillStyle:"transparent"},restitution:.8,frictionAir:.01,friction:.2});return y.Body.setVelocity(n,{x:5*(Math.random()-.5),y:0}),y.Body.setAngularVelocity(n,.05*(Math.random()-.5)),{elem:e,body:n}});S.forEach(({elem:e,body:t})=>{e.style.position="absolute",e.style.left=t.position.x-t.bounds.max.x+t.bounds.min.x/2+"px",e.style.top=t.position.y-t.bounds.max.y+t.bounds.min.y/2+"px",e.style.transform="none"});const k=n.create(h.current),A=i.create(f,{mouse:k,constraint:{stiffness:d,render:{visible:!1}}});j.mouse=k,a.add(f.world,[N,C,w,E,A,...S.map(e=>e.body)]);const T=r.create();r.run(T,f),t.run(j);const I=()=>{S.forEach(({body:e,elem:t})=>{const{x:a,y:s}=e.position;t.style.left=`${a}px`,t.style.top=`${s}px`,t.style.transform=`translate(-50%, -50%) rotate(${e.angle}rad)`}),y.Engine.update(f),requestAnimationFrame(I)};return I(),()=>{if(t.stop(j),r.stop(T),j.canvas&&p.current)try{p.current.removeChild(j.canvas)}catch(s){}a.clear(f.world),e.clear(f)}},[g,c,l,o,d]);const v=()=>{g||"click"!==i&&"hover"!==i||x(!0)};return s.jsxs("div",{ref:h,className:`falling-text-container ${e}`,onClick:"click"===i?v:void 0,onMouseEnter:"hover"===i?v:void 0,style:{position:"relative",overflow:"hidden"},children:[s.jsx("div",{ref:m,className:"falling-text-target",style:{fontSize:u,lineHeight:1.4}}),s.jsx("div",{ref:p,className:"falling-text-canvas"})]})};const ve=({children:e,variant:t="fade-up",delay:r=0,threshold:n=.1,className:i=""})=>{const[o,l]=function(e={}){const{threshold:t=.1,rootMargin:s="0px",triggerOnce:r=!0}=e,n=a.useRef(null),[i,o]=a.useState(!1);return a.useEffect(()=>{const e=n.current;if(!e)return;const a=new IntersectionObserver(([t])=>{t.isIntersecting?(o(!0),r&&a.unobserve(e)):r||o(!1)},{threshold:t,rootMargin:s});return a.observe(e),()=>{e&&a.unobserve(e)}},[t,s,r]),[n,i]}({threshold:n,triggerOnce:!0});return s.jsx("div",{ref:o,className:`reveal-container ${t} ${l?"revealed":""} ${i}`,style:{"--reveal-delay":`${r}ms`},children:e})},fe=({children:e,className:t="",spotlightColor:r="rgba(255, 255, 255, 0.25)",spotlightSize:n=300})=>{const i=a.useRef(null),[o,l]=a.useState({x:50,y:50}),[c,d]=a.useState(!1);return s.jsxs("div",{ref:i,className:`spotlight-card ${t}`,onMouseMove:e=>{if(!i.current)return;const t=i.current.getBoundingClientRect(),a=(e.clientX-t.left)/t.width*100,s=(e.clientY-t.top)/t.height*100;l({x:a,y:s})},onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),style:{"--spotlight-x":`${o.x}%`,"--spotlight-y":`${o.y}%`,"--spotlight-opacity":c?"1":"0","--spotlight-color":r,"--spotlight-size":`${n}px`},children:[s.jsx("div",{className:"spotlight-card-spotlight"}),s.jsx("div",{className:"spotlight-card-content",children:e})]})},je=({raysOrigin:e="bottom-center",raysSpeed:t=.4,lightSpread:r=.2,rayLength:n=1.3,fadeDistance:i=1.2,saturation:o=.9,mouseInfluence:l=.4,noiseAmount:c=0,distortion:d=0,pulsating:u=!1,raysColor:h="rgba(6, 182, 212, 1.0)"})=>{const m=a.useRef(null),p=a.useRef(null),g=a.useRef(null),y=a.useRef(null),b=a.useRef(null),N=a.useRef({x:.5,y:.5}),C=a.useRef(0),w=e=>{const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);return t?[parseInt(t[1])/255,parseInt(t[2])/255,parseInt(t[3])/255]:[.024,.714,.831]};return a.useEffect(()=>{if(!m.current)return;const a=new x({width:m.current.offsetWidth,height:m.current.offsetHeight,dpr:Math.min(window.devicePixelRatio,2),alpha:!0}),s=a.gl;m.current.appendChild(s.canvas),p.current=a;const E=new v(s,{vertex:"\n      attribute vec2 position;\n      attribute vec2 uv;\n      varying vec2 vUv;\n      void main() {\n        vUv = uv;\n        gl_Position = vec4(position, 0.0, 1.0);\n      }\n    ",fragment:"\n      precision highp float;\n      uniform float uTime;\n      uniform vec2 uResolution;\n      uniform vec2 uRaysOrigin;\n      uniform vec2 uMouse;\n      uniform float uRaysSpeed;\n      uniform float uLightSpread;\n      uniform float uRayLength;\n      uniform float uFadeDistance;\n      uniform float uSaturation;\n      uniform float uMouseInfluence;\n      uniform float uNoiseAmount;\n      uniform float uDistortion;\n      uniform float uPulsating;\n      uniform vec3 uRaysColor;\n      varying vec2 vUv;\n\n      // Noise function\n      float noise(vec2 st) {\n        return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);\n      }\n\n      float fbm(vec2 st) {\n        float value = 0.0;\n        float amplitude = 0.5;\n        float frequency = 1.0;\n        for (int i = 0; i < 4; i++) {\n          value += amplitude * noise(st * frequency);\n          frequency *= 2.0;\n          amplitude *= 0.5;\n        }\n        return value;\n      }\n\n      void main() {\n        vec2 uv = vUv;\n        vec2 st = uv * 2.0 - 1.0;\n        st.x *= uResolution.x / uResolution.y;\n\n        // Adjust origin based on aspect ratio\n        vec2 origin = uRaysOrigin * 2.0 - 1.0;\n        origin.x *= uResolution.x / uResolution.y;\n\n        // Apply mouse influence to origin\n        vec2 mouseOffset = (uMouse - 0.5) * uMouseInfluence;\n        origin += mouseOffset;\n\n        // Calculate direction from origin to current pixel\n        vec2 dir = st - origin;\n        float dist = length(dir);\n        dir = normalize(dir);\n\n        // Calculate angle for ray pattern\n        float angle = atan(dir.y, dir.x);\n\n        // Create rotating ray pattern\n        float rayPattern = 0.0;\n        const float numRays = 12.0;\n        float rayTime = uTime * uRaysSpeed;\n\n        for (float i = 0.0; i < numRays; i++) {\n          float rayAngle = (i / numRays) * 6.28318 + rayTime;\n          float angleDiff = abs(mod(angle - rayAngle + 3.14159, 6.28318) - 3.14159);\n\n          // Add noise to rays if enabled\n          float noiseVal = 1.0;\n          if (uNoiseAmount > 0.0) {\n            noiseVal = fbm(dir * 3.0 + uTime * 0.1) * uNoiseAmount + (1.0 - uNoiseAmount);\n          }\n\n          float rayWidth = uLightSpread * noiseVal;\n          float ray = smoothstep(rayWidth, 0.0, angleDiff);\n\n          // Add distortion if enabled\n          if (uDistortion > 0.0) {\n            float distortNoise = fbm(st * 2.0 + uTime * 0.2);\n            ray *= (1.0 - uDistortion) + distortNoise * uDistortion;\n          }\n\n          rayPattern += ray;\n        }\n\n        rayPattern = clamp(rayPattern, 0.0, 1.0);\n\n        // Distance-based fade\n        float fade = 1.0 - smoothstep(0.0, uFadeDistance, dist);\n\n        // Ray length control\n        float lengthMask = smoothstep(uRayLength, uRayLength * 0.5, dist);\n\n        // Pulsating effect\n        float pulse = 1.0;\n        if (uPulsating > 0.5) {\n          pulse = 0.7 + 0.3 * sin(uTime * 2.0);\n        }\n\n        // Combine all effects\n        float intensity = rayPattern * fade * lengthMask * pulse;\n\n        // Apply saturation to color\n        vec3 finalColor = uRaysColor * uSaturation;\n\n        // Output with alpha - increased visibility\n        gl_FragColor = vec4(finalColor, intensity * 0.95);\n      }\n    ",uniforms:{uTime:{value:0},uResolution:{value:[m.current.offsetWidth,m.current.offsetHeight]},uRaysOrigin:{value:{top:[.5,1],"top-left":[0,1],"top-right":[1,1],bottom:[.5,0],"bottom-center":[.5,0],"bottom-left":[0,0],"bottom-right":[1,0],left:[0,.5],right:[1,.5],center:[.5,.5]}[e]||[.5,0]},uMouse:{value:[.5,.5]},uRaysSpeed:{value:t},uLightSpread:{value:r},uRayLength:{value:n},uFadeDistance:{value:i},uSaturation:{value:o},uMouseInfluence:{value:l},uNoiseAmount:{value:c},uDistortion:{value:d},uPulsating:{value:u?1:0},uRaysColor:{value:w(h)}},transparent:!0});g.current=E;const S=new f(s),k=new j(s,{geometry:S,program:E});y.current=k;const A=e=>{const t=m.current.getBoundingClientRect();N.current={x:(e.clientX-t.left)/t.width,y:1-(e.clientY-t.top)/t.height}},T=()=>{if(!m.current)return;const e=m.current.offsetWidth,t=m.current.offsetHeight;a.setSize(e,t),E.uniforms.uResolution.value=[e,t]};window.addEventListener("mousemove",A),window.addEventListener("resize",T);const I=e=>{C.current=.001*e,E.uniforms.uTime.value=C.current,E.uniforms.uMouse.value=[N.current.x,N.current.y],a.render({scene:k}),b.current=requestAnimationFrame(I)};return b.current=requestAnimationFrame(I),()=>{var e;window.removeEventListener("mousemove",A),window.removeEventListener("resize",T),b.current&&cancelAnimationFrame(b.current),s.canvas&&(null==(e=m.current)?void 0:e.contains(s.canvas))&&m.current.removeChild(s.canvas)}},[e,t,r,n,i,o,l,c,d,u,h]),s.jsx("div",{ref:m,className:"light-rays-container"})};function be(...e){return e.filter(Boolean).join(" ")}const Ne=a.forwardRef((e,t)=>{const{texts:r,transition:n={type:"spring",damping:25,stiffness:300},initial:i={y:"100%",opacity:0},animate:o={y:0,opacity:1},exit:l={y:"-120%",opacity:0},animatePresenceMode:c="wait",animatePresenceInitial:d=!1,rotationInterval:u=2e3,staggerDuration:h=0,staggerFrom:m="first",loop:p=!0,auto:g=!0,splitBy:y="characters",onNext:x,mainClassName:v,splitLevelClassName:f,elementLevelClassName:j,...C}=e,[w,E]=a.useState(0),S=e=>{if("undefined"!=typeof Intl&&Intl.Segmenter){const t=new Intl.Segmenter("en",{granularity:"grapheme"});return Array.from(t.segment(e),e=>e.segment)}return Array.from(e)},k=a.useMemo(()=>{const e=r[w];if("characters"===y){const t=e.split(" ");return t.map((e,a)=>({characters:S(e),needsSpace:a!==t.length-1}))}return"words"===y?e.split(" ").map((e,t,a)=>({characters:[e],needsSpace:t!==a.length-1})):"lines"===y?e.split("\n").map((e,t,a)=>({characters:[e],needsSpace:t!==a.length-1})):e.split(y).map((e,t,a)=>({characters:[e],needsSpace:t!==a.length-1}))},[r,w,y]),A=a.useCallback((e,t)=>{const a=t;if("first"===m)return e*h;if("last"===m)return(a-1-e)*h;if("center"===m){const t=Math.floor(a/2);return Math.abs(t-e)*h}if("random"===m){const t=Math.floor(Math.random()*a);return Math.abs(t-e)*h}return Math.abs(m-e)*h},[m,h]),T=a.useCallback(e=>{E(e),x&&x(e)},[x]),I=a.useCallback(()=>{const e=w===r.length-1?p?0:w:w+1;e!==w&&T(e)},[w,r.length,p,T]),M=a.useCallback(()=>{const e=0===w?p?r.length-1:w:w-1;e!==w&&T(e)},[w,r.length,p,T]),R=a.useCallback(e=>{const t=Math.max(0,Math.min(e,r.length-1));t!==w&&T(t)},[r.length,w,T]),P=a.useCallback(()=>{0!==w&&T(0)},[w,T]);return a.useImperativeHandle(t,()=>({next:I,previous:M,jumpTo:R,reset:P}),[I,M,R,P]),a.useEffect(()=>{if(!g)return;const e=setInterval(I,u);return()=>clearInterval(e)},[I,u,g]),s.jsxs(b.span,{className:be("text-rotate",v),...C,layout:!0,transition:n,children:[s.jsx("span",{className:"text-rotate-sr-only",children:r[w]}),s.jsx(N,{mode:c,initial:d,children:s.jsx(b.span,{className:be("lines"===y?"text-rotate-lines":"text-rotate"),layout:!0,"aria-hidden":"true",children:k.map((e,t,a)=>{const r=a.slice(0,t).reduce((e,t)=>e+t.characters.length,0);return s.jsxs("span",{className:be("text-rotate-word",f),children:[e.characters.map((e,t)=>s.jsx(b.span,{initial:i,animate:o,exit:l,transition:{...n,delay:A(r+t,a.reduce((e,t)=>e+t.characters.length,0))},className:be("text-rotate-element",j),children:e},t)),e.needsSpace&&s.jsx("span",{className:"text-rotate-space",children:" "})]},t)})},w)})]})});Ne.displayName="RotatingText";const Ce=({children:e,padding:t=100,disabled:r=!1,magnetStrength:n=2,activeTransition:i="transform 0.3s ease-out",inactiveTransition:o="transform 0.5s ease-in-out",wrapperClassName:l="",innerClassName:c="",...d})=>{const[u,h]=a.useState(!1),[m,p]=a.useState({x:0,y:0}),g=a.useRef(null),y="undefined"!=typeof window&&window.innerWidth<768;a.useEffect(()=>{if(r||y)return void p({x:0,y:0});const e=e=>{if(!g.current)return;const{left:a,top:s,width:r,height:i}=g.current.getBoundingClientRect(),o=a+r/2,l=s+i/2,c=Math.abs(o-e.clientX),d=Math.abs(l-e.clientY);if(c<r/2+t&&d<i/2+t){h(!0);const t=(e.clientX-o)/n,a=(e.clientY-l)/n;p({x:t,y:a})}else h(!1),p({x:0,y:0})};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}},[t,r,n,y]);const x=u?i:o;return s.jsx("div",{ref:g,className:l,style:{position:"relative",display:"inline-block"},...d,children:s.jsx("div",{className:c,style:{transform:`translate3d(${m.x}px, ${m.y}px, 0)`,transition:x,willChange:"transform"},children:e})})};function we(){const[e,t]=a.useState(!1),r=n(),{startTransition:o}=A();V(),ie("premium-paywall");const l=()=>{r("/login"),o("/login")},c=()=>{r("/premium"),o("/premium")},d=()=>{r("/login"),o("/login")};return s.jsxs("div",{className:"index-page",children:[s.jsxs(i,{children:[s.jsx("title",{children:"JustLayMe - The Grey Mirror | AI-Powered Self-Reflection & Analysis"}),s.jsx("meta",{name:"description",content:"Upload your conversations and watch The Grey Mirror reveal hidden patterns, expose uncomfortable truths, and show you exactly who you are through revolutionary AI analysis."}),s.jsx("link",{rel:"canonical",href:"https://justlay.me/"}),s.jsx("meta",{property:"og:title",content:"JustLayMe - The Grey Mirror | AI-Powered Self-Reflection & Analysis"}),s.jsx("meta",{property:"og:description",content:"Upload your conversations and watch The Grey Mirror reveal hidden patterns, expose uncomfortable truths, and show you exactly who you are through revolutionary AI analysis."}),s.jsx("meta",{property:"og:url",content:"https://justlay.me/"}),s.jsx("meta",{property:"og:type",content:"website"}),s.jsx("meta",{property:"og:image",content:"https://justlay.me/og-image.jpg"}),s.jsx("meta",{property:"og:image:width",content:"1200"}),s.jsx("meta",{property:"og:image:height",content:"630"}),s.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),s.jsx("meta",{name:"twitter:title",content:"JustLayMe - The Grey Mirror | AI-Powered Self-Reflection & Analysis"}),s.jsx("meta",{name:"twitter:description",content:"Upload your conversations and watch The Grey Mirror reveal hidden patterns, expose uncomfortable truths, and show you exactly who you are through revolutionary AI analysis."}),s.jsx("meta",{name:"twitter:image",content:"https://justlay.me/twitter-image.jpg"})]}),s.jsx(je,{raysOrigin:"bottom-center",raysSpeed:.4,lightSpread:.2,rayLength:1.3,fadeDistance:1.2,saturation:.9,mouseInfluence:.4,noiseAmount:0,distortion:0,pulsating:!0}),s.jsxs("nav",{className:"navbar",children:[s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"navbar-brand",style:{fontSize:"1.5rem",fontWeight:"600"},children:["Justlay.",s.jsx(Ne,{texts:["Me","You","Her","Him","Yourself","Everyone","Someone","Back","Down","Low"],mainClassName:"rotating-brand-highlight",splitBy:"words",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},rotationInterval:2e3})]}),s.jsxs("div",{className:"navbar-links desktop",children:[s.jsx("a",{href:"#features",children:"Features"}),s.jsx("a",{href:"#pricing",children:"Pricing"}),s.jsx("a",{href:"#about",children:"About"}),s.jsx(Ce,{padding:80,magnetStrength:3,children:s.jsx("button",{className:"btn-nav",onClick:l,children:"Sign Up"})}),s.jsx(Ce,{padding:80,magnetStrength:3,children:s.jsx("button",{className:"btn-nav",onClick:d,children:"Sign In"})})]}),s.jsxs("div",{className:"navbar-mobile",children:[s.jsx(Ce,{padding:40,magnetStrength:2,children:s.jsx("button",{className:"btn-nav mobile-signup",onClick:l,children:"Sign Up"})}),s.jsx(Ce,{padding:40,magnetStrength:2,children:s.jsx("button",{className:"btn-nav mobile-signin",onClick:d,children:"Sign In"})}),s.jsx("button",{className:"mobile-menu-toggle",onClick:()=>t(!e),"aria-label":"Toggle menu",children:s.jsxs("span",{className:"hamburger "+(e?"active":""),children:[s.jsx("span",{}),s.jsx("span",{}),s.jsx("span",{})]})})]})]}),e&&s.jsx("div",{className:"mobile-menu-overlay",children:s.jsxs("div",{className:"mobile-menu-content",children:[s.jsx("a",{href:"#features",onClick:()=>t(!1),children:"Features"}),s.jsx("a",{href:"#pricing",onClick:()=>t(!1),children:"Pricing"}),s.jsx("a",{href:"#about",onClick:()=>t(!1),children:"About"}),s.jsx("a",{href:"/terms",onClick:()=>t(!1),children:"Terms"}),s.jsx("a",{href:"/privacy",onClick:()=>t(!1),children:"Privacy"})]})})]}),s.jsxs("main",{children:[s.jsx("section",{className:"hero",children:s.jsxs("div",{className:"container hero-container",children:[s.jsxs("div",{className:"hero-left",children:[s.jsx("h1",{children:s.jsx(ye,{speed:5,children:"The Grey Mirror: See Yourself Clearly"})}),s.jsx("p",{className:"hero-subtitle",children:s.jsx(ye,{speed:4,children:"Upload your conversations. Watch AI reveal hidden patterns, expose uncomfortable truths, and show you exactly who you are."})}),s.jsxs("p",{className:"hero-technical-details",style:{fontSize:"0.85rem",opacity:.85,marginTop:"1rem",lineHeight:"1.6",maxWidth:"600px"},children:["Upload years of text messages and leverage advanced ML classifiers with unlimited context to analyze ",s.jsx("strong",{children:"7+ comprehensive relationship metrics"})," including who apologizes more, who double-texts, sentiment patterns, toxicity levels, and emotional engagement. These hard numbers are then synthesized by cutting-edge AI to deliver the most accurate relationship analysis available on the internet."]}),s.jsx("div",{className:"hero-cta-buttons",children:s.jsx(Ce,{padding:80,magnetStrength:3,children:s.jsx("button",{className:"btn-primary btn-large",onClick:l,children:"Create Account"})})}),s.jsx("p",{className:"hero-hint",children:"Sign up to start analyzing your relationships with The Grey Mirror"}),s.jsxs("div",{className:"hero-stats",children:[s.jsxs("div",{className:"stat",children:[s.jsx("span",{className:"stat-value",children:"10K+"}),s.jsx("span",{className:"stat-label",children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Active Users"})})]}),s.jsxs("div",{className:"stat",children:[s.jsx("span",{className:"stat-value",children:"4.8★"}),s.jsx("span",{className:"stat-label",children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Avg Rating"})})]}),s.jsxs("div",{className:"stat",children:[s.jsx("span",{className:"stat-value",children:"24/7"}),s.jsx("span",{className:"stat-label",children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Available"})})]})]})]}),s.jsx("div",{className:"hero-right",children:s.jsx("div",{className:"black-mirror-card-wrapper",onClick:()=>{r("/grey-mirror"),o("/grey-mirror")},style:{cursor:"pointer"},children:s.jsx(ge,{name:"The Grey Mirror",title:"Enter The Mirror",handle:"justlayme",status:"Revolutionary AI Analysis",showUserInfo:!1,enableTilt:!0,enableMobileTilt:!0,behindGlowEnabled:!0,behindGlowColor:"rgba(6, 182, 212, 0.5)",children:s.jsx(xe,{text:"Upload conversations & memories. Watch as The Mirror reveals hidden patterns, exposes truths, and shows you exactly who you are",highlightWords:["Mirror","reveals","patterns","truths"],highlightClass:"highlighted",trigger:"hover",backgroundColor:"transparent",wireframes:!1,gravity:.7,mouseConstraintStiffness:.7,fontSize:"0.8rem"})})})})]})}),s.jsx("section",{className:"features",id:"features",children:s.jsxs("div",{className:"container",children:[s.jsx(ve,{variant:"materialize",delay:0,children:s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{children:"Why Users Love Justlay.Me"}),s.jsx("p",{children:s.jsx(ye,{speed:4,children:"Everything you need for meaningful AI conversations"})})]})}),s.jsxs("div",{className:"features-grid",children:[s.jsx(ve,{variant:"quantum",delay:100,children:s.jsxs(fe,{className:"feature variant-elevated",children:[s.jsx("h3",{children:"Advanced AI Models"}),s.jsx("p",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Powered by state-of-the-art language models that understand context, nuance, and deliver intelligent responses."})})]})}),s.jsx(ve,{variant:"quantum",delay:200,children:s.jsxs(fe,{className:"feature variant-elevated",children:[s.jsx("h3",{children:"Custom AI Characters"}),s.jsx("p",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Create unique AI personas with distinct personalities, voices, and conversation styles tailored to your needs."})})]})}),s.jsx(ve,{variant:"quantum",delay:300,children:s.jsxs(fe,{className:"feature variant-elevated",children:[s.jsx("h3",{children:"Conversation Memory"}),s.jsx("p",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Your conversations are saved with full context. AI remembers everything and picks up exactly where you left off."})})]})}),s.jsx(ve,{variant:"quantum",delay:100,children:s.jsxs(fe,{className:"feature variant-elevated",children:[s.jsx("h3",{children:"Instant Responses"}),s.jsx("p",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Lightning-fast reply generation. Get responses in seconds, not minutes. Optimized for real-time interaction."})})]})}),s.jsx(ve,{variant:"quantum",delay:200,children:s.jsxs(fe,{className:"feature variant-elevated",children:[s.jsx("h3",{children:"Private & Secure"}),s.jsx("p",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"End-to-end encryption keeps your conversations completely private. Your data is yours alone."})})]})}),s.jsx(ve,{variant:"quantum",delay:300,children:s.jsxs(fe,{className:"feature variant-elevated",children:[s.jsx("h3",{children:"Voice Cloning"}),s.jsx("p",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Clone your voice for natural speech interaction. Communicate with AI using your own voice and personality."})})]})})]})]})}),s.jsx("section",{className:"pricing",id:"pricing",children:s.jsxs("div",{className:"container",children:[s.jsx(ve,{variant:"materialize",delay:0,children:s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{children:"Simple, Transparent Pricing"}),s.jsx("p",{children:s.jsx(ye,{speed:4,children:"Choose the plan that fits your needs"})})]})}),s.jsxs("div",{className:"pricing-grid",children:[s.jsx(ve,{variant:"slide-left",delay:100,children:s.jsxs(fe,{className:"pricing-card",children:[s.jsx("h3",{children:"Free"}),s.jsxs("div",{className:"price",children:["$0",s.jsx("span",{className:"period",children:"/month"})]}),s.jsxs("ul",{className:"features-list",children:[s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Limited conversations"})}),s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Basic AI models"})}),s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"1 character slot"})}),s.jsx("li",{className:"unavailable",children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Voice cloning"})}),s.jsx("li",{className:"unavailable",children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Priority support"})})]}),s.jsx(Ce,{padding:80,magnetStrength:3,children:s.jsx("button",{className:"btn-secondary",onClick:l,children:"Sign Up"})})]})}),s.jsx(ve,{variant:"materialize",delay:200,children:s.jsxs(fe,{className:"pricing-card featured",spotlightColor:"rgba(6, 182, 212, 0.3)",children:[s.jsx("div",{className:"badge",children:"Most Popular"}),s.jsx("h3",{children:"Premium"}),s.jsxs("div",{className:"price",children:["$9.99",s.jsx("span",{className:"period",children:"/month"})]}),s.jsxs("ul",{className:"features-list",children:[s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Unlimited conversations"})}),s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"All AI models"})}),s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Unlimited characters"})}),s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Voice cloning"})}),s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Priority support"})})]}),s.jsx(Ce,{padding:80,magnetStrength:3,children:s.jsx("button",{className:"btn-primary",onClick:c,children:"Subscribe Now"})})]})}),s.jsx(ve,{variant:"slide-right",delay:100,children:s.jsxs(fe,{className:"pricing-card",children:[s.jsx("h3",{children:"Pro"}),s.jsxs("div",{className:"price",children:["$19.99",s.jsx("span",{className:"period",children:"/month"})]}),s.jsxs("ul",{className:"features-list",children:[s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Everything in Premium"})}),s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"API Access"})}),s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Custom models"})}),s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Advanced analytics"})}),s.jsx("li",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"Dedicated support"})})]}),s.jsx(Ce,{padding:80,magnetStrength:3,children:s.jsx("button",{className:"btn-secondary",onClick:c,children:"Subscribe Now"})})]})})]})]})}),s.jsx("section",{className:"cta",children:s.jsx(ve,{variant:"emerge",delay:0,children:s.jsxs("div",{className:"container",children:[s.jsx("h2",{children:"Ready to see the truth?"}),s.jsx("p",{children:s.jsx(ye,{speed:4,children:"Join thousands discovering what The Grey Mirror reveals about them"})}),s.jsx(Ce,{padding:100,magnetStrength:2.5,children:s.jsx("button",{className:"btn-primary btn-large",onClick:()=>{r("/chat"),o("/chat")},children:"Get Started"})})]})})})]}),s.jsx("footer",{className:"footer",children:s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"footer-grid",children:[s.jsxs("div",{className:"footer-col",children:[s.jsxs("h4",{style:{fontSize:"1.5rem",fontWeight:"600"},children:["Justlay.",s.jsx(Ne,{texts:["Me","You","Her","Him","Yourself","Everyone","Someone","Back","Down","Low"],mainClassName:"rotating-brand-highlight",splitBy:"words",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},rotationInterval:2e3})]}),s.jsx("p",{children:s.jsx(ye,{speed:3,className:"variant-subtle",children:"AI-powered self-reflection & analysis"})})]}),s.jsxs("div",{className:"footer-col",children:[s.jsx("h4",{children:"Product"}),s.jsxs("ul",{children:[s.jsx("li",{children:s.jsx("a",{href:"#features",children:"Features"})}),s.jsx("li",{children:s.jsx("a",{href:"#pricing",children:"Pricing"})}),s.jsx("li",{children:s.jsx("a",{href:"#about",children:"About"})})]})]}),s.jsxs("div",{className:"footer-col",children:[s.jsx("h4",{children:"Legal"}),s.jsxs("ul",{children:[s.jsx("li",{children:s.jsx("a",{href:"/terms",children:"Terms"})}),s.jsx("li",{children:s.jsx("a",{href:"/privacy",children:"Privacy"})}),s.jsx("li",{children:s.jsx("a",{href:"/contact",children:"Contact"})})]})]}),s.jsxs("div",{className:"footer-col",children:[s.jsx("h4",{children:"Connect"}),s.jsxs("ul",{children:[s.jsx("li",{children:s.jsx("a",{href:"#",children:"Twitter"})}),s.jsx("li",{children:s.jsx("a",{href:"#",children:"Discord"})}),s.jsx("li",{children:s.jsx("a",{href:"#",children:"GitHub"})})]})]})]}),s.jsx("div",{className:"footer-bottom",children:s.jsx("p",{children:"© 2024 Justlay.Me. All rights reserved."})})]})})]})}let Ee;try{const e=require("@react-oauth/google");Ee=e.GoogleLogin}catch{Ee=null}function Se(){const[e,t]=a.useState(!0),[r,o]=a.useState(""),[l,c]=a.useState(""),[d,u]=a.useState(""),[h,m]=a.useState(!1),[p,g]=a.useState(""),y=n(),{login:x,signup:v,setUser:f}=V(),{startTransition:j}=A(),[b,N]=a.useState(!1),C=!!Ee;return s.jsxs("div",{className:"login-page",children:[s.jsxs(i,{children:[s.jsx("title",{children:"Sign In to JustLayMe - Unfiltered AI Chat"}),s.jsx("meta",{name:"description",content:"Log in to your JustLayMe account to access your AI conversations, custom characters, and The Grey Mirror analysis tool."}),s.jsx("link",{rel:"canonical",href:"https://justlay.me/login"}),s.jsx("meta",{property:"og:title",content:"Sign In to JustLayMe - Unfiltered AI Chat"}),s.jsx("meta",{property:"og:description",content:"Log in to your JustLayMe account to access your AI conversations, custom characters, and The Grey Mirror analysis tool."}),s.jsx("meta",{property:"og:url",content:"https://justlay.me/login"}),s.jsx("meta",{property:"og:type",content:"website"}),s.jsx("meta",{property:"og:image",content:"https://justlay.me/og-image.jpg"}),s.jsx("meta",{property:"og:image:width",content:"1200"}),s.jsx("meta",{property:"og:image:height",content:"630"}),s.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),s.jsx("meta",{name:"twitter:title",content:"Sign In to JustLayMe - Unfiltered AI Chat"}),s.jsx("meta",{name:"twitter:description",content:"Log in to your JustLayMe account to access your AI conversations, custom characters, and The Grey Mirror analysis tool."}),s.jsx("meta",{name:"twitter:image",content:"https://justlay.me/twitter-image.jpg"})]}),s.jsx("div",{className:"login-container",children:s.jsxs("div",{className:"login-box",children:[s.jsx("h1",{className:"login-title",children:"Justlay.Me"}),s.jsx("p",{className:"login-subtitle",children:"Unfiltered AI Conversations"}),b&&s.jsxs("div",{className:"success-message",children:[s.jsx("div",{className:"success-icon",children:"✓"}),s.jsx("h3",{children:"Account Created!"}),s.jsxs("p",{children:["Check your email (",r,") for a verification link."]}),s.jsx("p",{className:"redirect-notice",children:"Redirecting to chat in a moment..."})]}),C&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"google-signin-wrapper",children:s.jsx(Ee,{onSuccess:async e=>{m(!0),g("");try{console.log("Google sign-in success, sending to backend...");const t=await T.post("/auth/google",{credential:e.credential});localStorage.setItem("authToken",t.token),f(t.user),j("/chat"),setTimeout(()=>y("/chat"),100)}catch(t){console.error("Google login error:",t),g(t.message||"Google sign-in failed. Please try again."),m(!1)}},onError:()=>{console.error("Google sign-in failed"),g("Google sign-in failed. Please try again."),m(!1)},theme:"filled_blue",size:"large",text:e?"signin_with":"signup_with",width:"100%",logo_alignment:"left"})}),s.jsx("div",{className:"divider",children:s.jsx("span",{children:"OR"})})]}),s.jsxs("form",{onSubmit:async t=>{var a,s;t.preventDefault(),g(""),m(!0);try{if(e){console.log("Attempting login with email:",r);const e=await x(r,l);console.log("Login successful:",e),j("/chat"),setTimeout(()=>y("/chat"),100)}else{console.log("Attempting signup with email:",r,"username:",d);const e=await v(r,l,d);console.log("Signup successful:",e),N(!0),m(!1),setTimeout(()=>{j("/chat"),y("/chat")},3e3)}}catch(n){console.error("Auth error:",n);let t=n.message||"Authentication failed. Please try again.";e?t.toLowerCase().includes("not found")||t.toLowerCase().includes("invalid")||t.toLowerCase().includes("no user")?t="Account not found. Don't have an account? Click 'Sign Up' below to create one.":t.toLowerCase().includes("password")&&(t="Incorrect password. Please try again or reset your password."):t.toLowerCase().includes("already exists")||t.toLowerCase().includes("already registered")?t="An account with this email already exists. Try signing in instead.":(t.toLowerCase().includes("validation failed")||n.details)&&(n.details&&Array.isArray(n.details)?t=n.details.map(e=>e.message).join("\n"):(null==(s=null==(a=n.response)?void 0:a.data)?void 0:s.details)&&(t=n.response.data.details.map(e=>e.message).join("\n"))),g(t),m(!1)}},className:"login-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"email",children:"Email Address"}),s.jsx("input",{id:"email",type:"email",placeholder:"your@email.com",value:r,onChange:e=>o(e.target.value),required:!0,disabled:h})]}),!e&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"username",children:"Username"}),s.jsx("input",{id:"username",type:"text",placeholder:"Choose a username",value:d,onChange:e=>u(e.target.value),required:!0,disabled:h})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"password",children:"Password"}),s.jsx("input",{id:"password",type:"password",placeholder:"••••••••",value:l,onChange:e=>c(e.target.value),required:!0,disabled:h,pattern:e?void 0:"^(?=.*[a-z])(?=.*[A-Z])(?=.*d)(?=.*[@$!%*?&#])[A-Za-zd@$!%*?&#]{8,}$"}),!e&&s.jsx("p",{className:"password-requirements",children:"Must include: 8+ chars, uppercase, lowercase, number, and special character (@$!%*?&#)"}),e&&s.jsx("div",{style:{textAlign:"right",marginTop:"0.5rem"},children:s.jsx("button",{type:"button",className:"toggle-button",onClick:()=>y("/forgot-password"),disabled:h,style:{fontSize:"0.9rem",padding:"0"},children:"Forgot password?"})})]}),p&&s.jsx("div",{className:"error-message",children:p}),s.jsx("button",{type:"submit",className:"btn-login",disabled:h,children:h?"Processing...":e?"Sign In":"Create Account"})]}),s.jsx("div",{className:"login-toggle",children:s.jsxs("p",{children:[e?"Don't have an account? ":"Already have an account? ",s.jsx("button",{type:"button",className:"toggle-button",onClick:()=>{t(!e),g("")},disabled:h,children:e?"Sign Up":"Sign In"})]})})]})})]})}function ke({size:e="medium",message:t="Loading...",centered:a=!0}){return s.jsxs("div",{className:"loading-spinner "+(a?"centered":""),children:[s.jsxs("div",{className:`spinner spinner-${e}`,children:[s.jsx("div",{className:"spinner-ring"}),s.jsx("div",{className:"spinner-ring"}),s.jsx("div",{className:"spinner-ring"})]}),t&&s.jsx("p",{className:"loading-message",children:t})]})}function Ae({children:e}){const t=o(),{isTransitioning:r,endTransition:n}=A(),i="/grey-mirror"===t.pathname?"The Grey Mirror":"JustLayMe";return console.log("[TransitionWrapper] Rendering with location:",t.pathname),a.useEffect(()=>{if(r){const e=setTimeout(()=>{n()},1200);return()=>clearTimeout(e)}},[r,n]),s.jsxs("div",{className:"transition-wrapper",children:[r&&s.jsx("div",{className:"page-transition-overlay portal-glow",children:s.jsx("div",{className:"logo-container",children:s.jsxs("div",{className:"justlayme-logo",children:[s.jsx("span",{className:"logo-text",children:i}),s.jsx("span",{className:"logo-subtitle",children:"The Grey Mirror"===i?"Deep Analysis":"AI Chat"})]})})}),s.jsx("div",{className:"route-content "+(r?"transitioning-out":"transitioning-in"),children:e})]})}const Te="CLOSED",Ie="OPEN",Me="HALF_OPEN";class Re{constructor({failureThreshold:e=5,resetTimeout:t=3e4,monitoringPeriod:a=6e4,name:s="CircuitBreaker"}={}){this.failureThreshold=e,this.resetTimeout=t,this.monitoringPeriod=a,this.name=s,this.state=Te,this.failureCount=0,this.lastFailureTime=null,this.nextAttemptTime=null,this.consecutiveSuccesses=0}async execute(e){if(this.state===Ie){if(!(Date.now()>=this.nextAttemptTime)){const e=Math.ceil((this.nextAttemptTime-Date.now())/1e3),t=new Error(`Circuit breaker is OPEN. Service unavailable. Retry in ${e}s`);throw t.circuitOpen=!0,t}console.log(`[${this.name}] Circuit entering HALF_OPEN state (testing recovery)`),this.state=Me}try{const t=await e();return this.onSuccess(),t}catch(t){throw this.onFailure(),t}}onSuccess(){this.consecutiveSuccesses++,this.state===Me?(console.log(`[${this.name}] Circuit CLOSED (service recovered)`),this.state=Te,this.failureCount=0,this.lastFailureTime=null):this.state===Te&&this.failureCount>0&&(this.failureCount=Math.max(0,this.failureCount-1))}onFailure(){this.failureCount++,this.lastFailureTime=Date.now(),this.consecutiveSuccesses=0,this.state===Me?(console.error(`[${this.name}] Circuit OPEN (recovery failed, ${this.failureCount} consecutive failures)`),this.state=Ie,this.nextAttemptTime=Date.now()+this.resetTimeout):this.failureCount>=this.failureThreshold&&(console.error(`[${this.name}] Circuit OPEN (threshold exceeded: ${this.failureCount}/${this.failureThreshold})`),this.state=Ie,this.nextAttemptTime=Date.now()+this.resetTimeout)}reset(){console.log(`[${this.name}] Circuit manually reset`),this.state=Te,this.failureCount=0,this.lastFailureTime=null,this.nextAttemptTime=null,this.consecutiveSuccesses=0}getStatus(){return{state:this.state,failureCount:this.failureCount,consecutiveSuccesses:this.consecutiveSuccesses,isOpen:this.state===Ie,nextAttemptTime:this.nextAttemptTime}}}const Pe=async()=>{try{return await T.get("conversations")}catch(e){throw console.error("Failed to fetch conversations:",e),e}},Le=async(e,t=0,a=50)=>{try{return await T.get(`/conversations/${e}/messages`,{params:{page:t,limit:a}})}catch(s){throw console.error("Failed to fetch messages:",s),s}},_e=async e=>{try{return await T.post("conversations",{characterId:e,startedAt:(new Date).toISOString()})}catch(t){throw console.error("Failed to start conversation:",t),t}},Oe=async(e,t,a=null,s={})=>{var r,n;try{let o=s.character||s.characterId||"layme_v1",l=s.characterName||null,c=s.isCustomCharacter||!1,d=s.customCharacterConfig||null;if(!s.character&&!s.characterId)try{const t=await T.get(`/conversations/${e}`);t&&t.characterId&&(o=t.characterId,l=t.characterName||null,c=t.isCustomCharacter||!1,c&&t.customCharacterConfig&&(d=t.customCharacterConfig))}catch(i){console.warn("Could not fetch conversation details, using default character")}let u=s.history||[];const h=await T.post("/chat",{message:t,character:o,characterName:l,isCustomCharacter:c,customCharacterConfig:d,conversationId:e,history:u,fileUrl:a}),m=h.response||h,p=(null==(r=h.message)?void 0:r.id)||`msg-${Date.now()}-user`;return{message:{id:p,conversationId:e,role:"user",content:t,fileUrl:a,timestamp:(null==(n=h.message)?void 0:n.timestamp)||(new Date).toISOString()},response:{id:`msg-${Date.now()}-assistant`,conversationId:e,role:"assistant",content:m,timestamp:(new Date).toISOString()}}}catch(o){throw console.error("Failed to send message:",o),o}},De=async(e,t)=>{try{return await T.delete(`/conversations/${e}/messages/${t}`)}catch(a){throw console.error("Failed to delete message:",a),a}},Fe=async e=>{try{return await T.delete(`/conversations/${e}`)}catch(t){throw console.error("Failed to delete conversation:",t),t}},Ge=a.createContext(),Ue={conversations:[],activeConversationId:null,messages:[],isLoadingConversations:!1,isLoadingMessages:!1,messageError:null,conversationError:null,typingIndicator:{isVisible:!1,characterName:""},pagination:{page:0,pageSize:50,hasMore:!1,total:0}},$e="SET_LOADING_CONVERSATIONS",ze="SET_LOADING_MESSAGES",Be="SET_CONVERSATIONS",Ve="SET_ACTIVE_CONVERSATION",qe="SET_MESSAGES",We="ADD_MESSAGE",He="PREPEND_MESSAGES",Ye="UPDATE_MESSAGE",Je="DELETE_MESSAGE",Xe="DELETE_CONVERSATION",Qe="SET_TYPING",Ze="CLEAR_TYPING",Ke="SET_MESSAGE_ERROR",et="SET_CONVERSATION_ERROR",tt="CLEAR_ERRORS",at="SET_PAGINATION";function st(e,t){switch(t.type){case $e:return{...e,isLoadingConversations:t.payload};case ze:return{...e,isLoadingMessages:t.payload};case Be:return{...e,conversations:t.payload};case Ve:return{...e,activeConversationId:t.payload,messages:[],pagination:{...Ue.pagination}};case qe:return{...e,messages:t.payload.messages,pagination:{...e.pagination,page:t.payload.page||0,total:t.payload.total||0,hasMore:t.payload.hasMore||!1}};case We:return{...e,messages:[...e.messages,t.payload]};case He:return{...e,messages:[...t.payload,...e.messages],pagination:{...e.pagination,page:e.pagination.page+1,hasMore:t.payload.length===e.pagination.pageSize}};case Ye:return{...e,messages:e.messages.map(e=>e.id===t.payload.id?(t.payload.updates.id&&(t.payload.updates.id,e.id),{...e,...t.payload.updates}):e)};case Je:return{...e,messages:e.messages.filter(e=>e.id!==t.payload)};case Xe:return{...e,conversations:e.conversations.filter(e=>e.id!==t.payload),activeConversationId:e.activeConversationId===t.payload?null:e.activeConversationId,messages:e.activeConversationId===t.payload?[]:e.messages};case Qe:return{...e,typingIndicator:{isVisible:!0,characterName:t.payload}};case Ze:return{...e,typingIndicator:{isVisible:!1,characterName:""}};case Ke:return{...e,messageError:t.payload};case et:return{...e,conversationError:t.payload};case tt:return{...e,messageError:null,conversationError:null};case at:return{...e,pagination:{...e.pagination,...t.payload}};default:return e}}function rt({children:e}){const[t,r]=a.useReducer(st,Ue),n=a.useRef(new Re({failureThreshold:5,resetTimeout:3e4,name:"ChatAPI"})),i=a.useCallback(e=>{r({type:$e,payload:e})},[]),o=a.useCallback(e=>{r({type:ze,payload:e})},[]),l=a.useCallback(e=>{r({type:Be,payload:e})},[]),c=a.useCallback(e=>{r({type:Ve,payload:e})},[]),d=a.useCallback((e,t,a,s)=>{r({type:qe,payload:{messages:e,page:t,total:a,hasMore:s}})},[]),u=a.useCallback(e=>{r({type:We,payload:e})},[]),h=a.useCallback(e=>{r({type:He,payload:e})},[]),m=a.useCallback((e,t)=>{r({type:Ye,payload:{id:e,updates:t}})},[]),p=a.useCallback(e=>{r({type:Je,payload:e})},[]),g=a.useCallback(e=>{r({type:Xe,payload:e})},[]),y=a.useCallback(e=>{r({type:Qe,payload:e})},[]),x=a.useCallback(()=>{r({type:Ze})},[]),v=a.useCallback(e=>{r({type:Ke,payload:e})},[]),f=a.useCallback(e=>{r({type:et,payload:e})},[]),j=a.useCallback(()=>{r({type:tt})},[]),b=a.useCallback(e=>{r({type:at,payload:e})},[]),N=a.useCallback(async()=>{i(!0);try{const e=await n.current.execute(async()=>await Pe());return l(e),e}catch(e){throw e.circuitOpen||console.error("[ChatContext] Failed to fetch conversations:",e.message),f(e.message),e}finally{i(!1)}},[i,l,f]),C=a.useCallback(async(e,a=0)=>{o(!0);try{const s=await n.current.execute(async()=>await Le(e,a,t.pagination.pageSize));return 0===a?d(s.messages,a,s.total,s.hasMore):h(s.messages),s}catch(s){throw s.circuitOpen||console.error("[ChatContext] Failed to fetch messages:",s.message),v(s.message),s}finally{o(!1)}},[o,d,h,v,t.pagination.pageSize]),w=a.useCallback(async e=>{i(!0);try{const a=await n.current.execute(async()=>await _e(e));return l([a,...t.conversations]),c(a.id),d([],0,0,!1),a}catch(a){throw a.circuitOpen||console.error("[ChatContext] Failed to start conversation:",a.message),f(a.message),a}finally{i(!1)}},[i,l,c,d,f,t.conversations]),E=a.useCallback(async(e,a=null,s={})=>{if(!t.activeConversationId)throw new Error("No active conversation");const r=`temp-${Date.now()}`,i={id:r,conversationId:t.activeConversationId,role:"user",content:e,fileUrl:a,timestamp:new Date,isOptimistic:!0};u(i);try{y("...");const i=t.messages.filter(e=>!e.isOptimistic).slice(-20).map(e=>({role:e.role,content:e.content})),o={...s,history:i},l=await n.current.execute(async()=>await Oe(t.activeConversationId,e,a,o));return m(r,{id:l.message.id,timestamp:l.message.timestamp,isOptimistic:!1}),l.response&&u(l.response),x(),l.message}catch(o){throw p(r),o.circuitOpen||console.error("[ChatContext] Failed to send message:",o.message),v(o.message),x(),o}},[t.activeConversationId,t.messages,u,y,m,x,p,v]),S=a.useCallback(async e=>{if(!t.activeConversationId)throw new Error("No active conversation");try{await n.current.execute(async()=>await De(t.activeConversationId,e)),p(e)}catch(a){throw a.circuitOpen||console.error("[ChatContext] Failed to delete message:",a.message),v(a.message),a}},[t.activeConversationId,p,v]),k=a.useCallback(async e=>{try{await n.current.execute(async()=>await Fe(e)),g(e)}catch(t){throw t.circuitOpen||console.error("[ChatContext] Failed to delete conversation:",t.message),f(t.message),t}},[g,f]),A={...t,setLoadingConversations:i,setLoadingMessages:o,setConversations:l,setActiveConversation:c,setMessages:d,addMessage:u,prependMessages:h,updateMessage:m,deleteMessage:p,deleteConversation:g,setTyping:y,clearTyping:x,setMessageError:v,setConversationError:f,clearErrors:j,setPagination:b,fetchConversations:N,fetchMessages:C,startConversation:w,sendMessage:E,deleteMessageById:S,deleteConversationById:k};return s.jsx(Ge.Provider,{value:A,children:e})}const nt=async()=>{try{return await T.get("characters")}catch(e){throw console.error("Failed to fetch characters:",e),e}},it=async e=>{var t,a,s,r,n;try{return await T.post("characters",{name:e.name,bio:e.bio,avatar:e.avatar,personality:"string"==typeof e.personality?e.personality:(null==(a=null==(t=e.personality)?void 0:t.traits)?void 0:a.join(", "))||"",voiceSettings:{voiceId:(null==(s=e.voiceSettings)?void 0:s.voiceId)||"default",pitch:(null==(r=e.voiceSettings)?void 0:r.pitch)||1,speed:(null==(n=e.voiceSettings)?void 0:n.speed)||1},systemPrompt:e.systemPrompt||""})}catch(i){throw console.error("Failed to create character:",i),i}},ot=async(e,t)=>{try{return await T.patch(`/characters/${e}`,{...t,updatedAt:(new Date).toISOString()})}catch(a){throw console.error("Failed to update character:",a),a}},lt=async e=>{try{return await T.delete(`/characters/${e}`)}catch(t){throw console.error("Failed to delete character:",t),t}},ct=async(e,t)=>{try{return await T.post("characters/test-response",{character:{name:e.name,bio:e.bio,personality:e.personality,systemPrompt:e.systemPrompt},prompt:t,timestamp:(new Date).toISOString()})}catch(a){throw console.error("Failed to test character response:",a),a}},dt=async(e=5)=>{try{return await T.get("characters/recent",{params:{limit:e}})}catch(t){throw console.error("Failed to fetch recent characters:",t),t}},ut=a.createContext(),ht={characters:[],activeCharacterId:null,recentCharacters:[],isLoadingCharacters:!1,isCreatingCharacter:!1,characterError:null},mt="SET_LOADING",pt="SET_CREATING",gt="SET_CHARACTERS",yt="SET_ACTIVE_CHARACTER",xt="ADD_CHARACTER",vt="UPDATE_CHARACTER",ft="DELETE_CHARACTER",jt="SET_RECENT_CHARACTERS",bt="SET_ERROR",Nt="CLEAR_ERROR";function Ct(e,t){switch(t.type){case mt:return{...e,isLoadingCharacters:t.payload};case pt:return{...e,isCreatingCharacter:t.payload};case gt:return{...e,characters:t.payload};case yt:return{...e,activeCharacterId:t.payload};case xt:return{...e,characters:[t.payload,...e.characters],activeCharacterId:t.payload.id};case vt:return{...e,characters:e.characters.map(e=>e.id===t.payload.id?{...e,...t.payload.updates}:e)};case ft:return{...e,characters:e.characters.filter(e=>e.id!==t.payload),activeCharacterId:e.activeCharacterId===t.payload?null:e.activeCharacterId};case jt:return{...e,recentCharacters:t.payload};case bt:return{...e,characterError:t.payload};case Nt:return{...e,characterError:null};default:return e}}function wt({children:e}){const[t,r]=a.useReducer(Ct,ht),n=a.useRef(new Re({failureThreshold:5,resetTimeout:3e4,name:"CharacterAPI"})),i=a.useCallback(e=>{r({type:mt,payload:e})},[]),o=a.useCallback(e=>{r({type:pt,payload:e})},[]),l=a.useCallback(e=>{r({type:gt,payload:e})},[]),c=a.useCallback(e=>{r({type:yt,payload:e})},[]),d=a.useCallback(e=>{r({type:xt,payload:e})},[]),u=a.useCallback((e,t)=>{r({type:vt,payload:{id:e,updates:t}})},[]),h=a.useCallback(e=>{r({type:ft,payload:e})},[]),m=a.useCallback(e=>{r({type:jt,payload:e})},[]),p=a.useCallback(e=>{r({type:bt,payload:e})},[]),g=a.useCallback(()=>{r({type:Nt})},[]),y=a.useCallback(async()=>{i(!0);try{const e=await n.current.execute(async()=>await nt());return l(e),e}catch(e){throw e.circuitOpen||console.error("[CharacterContext] Failed to fetch characters:",e.message),p(e.message),e}finally{i(!1)}},[i,l,p]),x=a.useCallback(async(e=5)=>{try{const t=await n.current.execute(async()=>await dt(e));return m(t),t}catch(t){throw t.circuitOpen||console.error("[CharacterContext] Failed to fetch recent characters:",t.message),p(t.message),t}},[m,p]),v=a.useCallback(async e=>{o(!0);try{const t=await n.current.execute(async()=>await it(e));return d(t),t}catch(t){throw t.circuitOpen||console.error("[CharacterContext] Failed to create character:",t.message),p(t.message),t}finally{o(!1)}},[o,d,p]),f=a.useCallback(async(e,t)=>{try{const a=await n.current.execute(async()=>await ot(e,t));return u(e,t),a}catch(a){throw a.circuitOpen||console.error("[CharacterContext] Failed to update character:",a.message),p(a.message),a}},[u,p]),j=a.useCallback(async e=>{try{await n.current.execute(async()=>await lt(e)),h(e)}catch(t){throw t.circuitOpen||console.error("[CharacterContext] Failed to delete character:",t.message),p(t.message),t}},[h,p]),b=a.useCallback(async(e,t)=>{try{return await n.current.execute(async()=>await ct(e,t))}catch(a){throw a.circuitOpen||console.error("[CharacterContext] Failed to test character response:",a.message),p(a.message),a}},[p]),N={...t,setLoading:i,setCreating:o,setCharacters:l,setActiveCharacter:c,addCharacter:d,updateCharacter:u,deleteCharacter:h,setRecentCharacters:m,setError:p,clearError:g,fetchCharacters:y,fetchRecentCharacters:x,createCharacter:v,updateCharacterData:f,deleteCharacterData:j,testResponse:b};return s.jsx(ut.Provider,{value:N,children:e})}const Et=a.createContext(),St={uploadedFile:null,uploadMethod:null,uploadProgress:0,isAnalyzing:!1,analysisId:null,analysisResults:null,mlReport:null,expandedMetrics:[],error:null,exportFormat:null,isExporting:!1,personalization:{userName:"You",contactName:"Them",insightsGoal:""}},kt="SET_UPLOADED_FILE",At="SET_UPLOAD_PROGRESS",Tt="SET_ANALYZING",It="SET_ANALYSIS_ID",Mt="SET_ANALYSIS_RESULTS",Rt="SET_ML_REPORT",Pt="TOGGLE_METRIC_EXPANDED",Lt="EXPAND_METRIC",_t="COLLAPSE_METRIC",Ot="COLLAPSE_ALL_METRICS",Dt="SET_ERROR",Ft="CLEAR_ERROR",Gt="SET_EXPORTING",Ut="CLEAR_RESULTS",$t="SET_PERSONALIZATION";function zt(e,t){switch(t.type){case kt:return{...e,uploadedFile:t.payload.file,uploadMethod:t.payload.method,uploadProgress:0};case At:return{...e,uploadProgress:t.payload};case Tt:return{...e,isAnalyzing:t.payload};case It:return{...e,analysisId:t.payload};case Mt:return{...e,analysisResults:t.payload,isAnalyzing:!1,error:null};case Rt:return{...e,mlReport:t.payload,isAnalyzing:!1,error:null};case Pt:const a=Array.isArray(e.expandedMetrics)?e.expandedMetrics:[];return{...e,expandedMetrics:a.includes(t.payload)?a.filter(e=>e!==t.payload):[...a,t.payload]};case Lt:const s=Array.isArray(e.expandedMetrics)?e.expandedMetrics:[];return{...e,expandedMetrics:s.includes(t.payload)?s:[...s,t.payload]};case _t:const r=Array.isArray(e.expandedMetrics)?e.expandedMetrics:[];return{...e,expandedMetrics:r.filter(e=>e!==t.payload)};case Ot:return{...e,expandedMetrics:[]};case Dt:return{...e,error:t.payload,isAnalyzing:!1};case Ft:return{...e,error:null};case Gt:return{...e,isExporting:t.payload};case Ut:return{...e,uploadedFile:null,uploadMethod:null,uploadProgress:0,analysisId:null,analysisResults:null,expandedMetrics:[],error:null};case $t:return{...e,personalization:{...e.personalization,...t.payload}};default:return e}}function Bt({children:e}){const[t,r]=a.useReducer(zt,St),n={...t,setUploadedFile:a.useCallback((e,t)=>{r({type:kt,payload:{file:e,method:t}})},[]),setUploadProgress:a.useCallback(e=>{r({type:At,payload:e})},[]),setAnalyzing:a.useCallback(e=>{r({type:Tt,payload:e})},[]),setAnalysisId:a.useCallback(e=>{r({type:It,payload:e})},[]),setAnalysisResults:a.useCallback(e=>{r({type:Mt,payload:e})},[]),setMLReport:a.useCallback(e=>{r({type:Rt,payload:e})},[]),toggleMetricExpanded:a.useCallback(e=>{r({type:Pt,payload:e})},[]),expandMetric:a.useCallback(e=>{r({type:Lt,payload:e})},[]),collapseMetric:a.useCallback(e=>{r({type:_t,payload:e})},[]),collapseAllMetrics:a.useCallback(()=>{r({type:Ot})},[]),setError:a.useCallback(e=>{r({type:Dt,payload:e})},[]),clearError:a.useCallback(()=>{r({type:Ft})},[]),setExporting:a.useCallback(e=>{r({type:Gt,payload:e})},[]),clearResults:a.useCallback(()=>{r({type:Ut})},[]),setPersonalization:a.useCallback(e=>{r({type:$t,payload:e})},[])};return s.jsx(Et.Provider,{value:n,children:e})}function Vt(){const e=a.useContext(ut);if(!e)throw new Error("useCharacters must be used within CharacterProvider");return{characters:e.characters,activeCharacterId:e.activeCharacterId,activeCharacter:e.characters.find(t=>t.id===e.activeCharacterId),recentCharacters:e.recentCharacters,isLoading:e.isLoadingCharacters,isCreating:e.isCreatingCharacter,error:e.characterError,setLoading:e.setLoading,setCreating:e.setCreating,setCharacters:e.setCharacters,setActiveCharacter:e.setActiveCharacter,addCharacter:e.addCharacter,updateCharacter:e.updateCharacter,deleteCharacter:e.deleteCharacter,setError:e.setError,clearError:e.clearError,fetchCharacters:e.fetchCharacters,fetchRecentCharacters:e.fetchRecentCharacters,createCharacter:e.createCharacter,updateCharacterData:e.updateCharacterData,deleteCharacterData:e.deleteCharacterData,testResponse:e.testResponse,selectCharacter:t=>{e.setActiveCharacter(t)}}}function qt(){const e=a.useContext(Ge);if(!e)throw new Error("useChat must be used within ChatProvider");return{conversations:e.conversations,activeConversationId:e.activeConversationId,messages:e.messages,isLoadingMessages:e.isLoadingMessages,isLoadingConversations:e.isLoadingConversations,messageError:e.messageError,conversationError:e.conversationError,typingIndicator:e.typingIndicator,pagination:e.pagination,setLoadingConversations:e.setLoadingConversations,setLoadingMessages:e.setLoadingMessages,setConversations:e.setConversations,setActiveConversation:e.setActiveConversation,setMessages:e.setMessages,addMessage:e.addMessage,prependMessages:e.prependMessages,updateMessage:e.updateMessage,deleteMessage:e.deleteMessage,deleteConversation:e.deleteConversation,setTyping:e.setTyping,clearTyping:e.clearTyping,setMessageError:e.setMessageError,setConversationError:e.setConversationError,clearErrors:e.clearErrors,setPagination:e.setPagination,fetchConversations:e.fetchConversations,fetchMessages:e.fetchMessages,startConversation:e.startConversation,sendMessage:e.sendMessage,deleteMessageById:e.deleteMessageById,deleteConversationById:e.deleteConversationById}}function Wt(){const e=a.useContext(q);if(!e)throw new Error("useNotification must be used within UIProvider");const t=a.useCallback((t,a="info",s=3e3)=>e.addNotification(t,a,s),[e]),s=a.useCallback((t,a=3e3)=>e.addNotification(t,"success",a),[e]),r=a.useCallback((t,a=5e3)=>e.addNotification(t,"error",a),[e]),n=a.useCallback((t,a=4e3)=>e.addNotification(t,"warning",a),[e]),i=a.useCallback((t,a=3e3)=>e.addNotification(t,"info",a),[e]);return{notifications:e.notificationQueue,notify:t,success:s,error:r,warning:n,info:i,remove:e.removeNotification}}class Ht extends a.Component{constructor(e){super(e),t(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})}),t(this,"handleReload",()=>{window.location.reload()}),this.state={hasError:!1,error:null,errorInfo:null,errorCount:0}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e),console.error("Component stack:",t.componentStack),this.setState(a=>({error:e,errorInfo:t,errorCount:a.errorCount+1}))}render(){if(this.state.hasError){const{error:e,errorInfo:t,errorCount:a}=this.state,{fallback:r}=this.props;return r?"function"==typeof r?r({error:e,errorInfo:t,reset:this.handleReset,reload:this.handleReload}):r:s.jsx("div",{className:"error-boundary",children:s.jsxs("div",{className:"error-boundary-content",children:[s.jsx("div",{className:"error-icon",children:"⚠️"}),s.jsx("h1",{className:"error-title",children:"Oops! Something went wrong"}),s.jsx("p",{className:"error-message",children:"We encountered an unexpected error. Don't worry, your data is safe."}),!1,s.jsxs("div",{className:"error-actions",children:[s.jsx("button",{className:"btn-primary",onClick:this.handleReset,children:"Try Again"}),s.jsx("button",{className:"btn-secondary",onClick:this.handleReload,children:"Reload Page"})]}),a>1&&s.jsxs("p",{className:"error-count",children:["Error occurred ",a," times. If this persists, try reloading the page."]})]})})}return this.props.children}}const Yt=[{id:"creative",label:"Creative",emoji:"🎨",color:"#8b5cf6"},{id:"logical",label:"Logical",emoji:"🧠",color:"#06b6d4"},{id:"empathetic",label:"Empathetic",emoji:"❤️",color:"#ec4899"},{id:"adventurous",label:"Adventurous",emoji:"🌟",color:"#f59e0b"},{id:"mysterious",label:"Mysterious",emoji:"🌙",color:"#6366f1"},{id:"playful",label:"Playful",emoji:"🎭",color:"#10b981"},{id:"serious",label:"Serious",emoji:"📚",color:"#64748b"},{id:"flirty",label:"Flirty",emoji:"😘",color:"#f43f5e"},{id:"dominant",label:"Dominant",emoji:"👑",color:"#dc2626"},{id:"submissive",label:"Submissive",emoji:"🦋",color:"#a78bfa"},{id:"witty",label:"Witty",emoji:"💡",color:"#fbbf24"},{id:"calm",label:"Calm",emoji:"🧘",color:"#34d399"}],Jt=[{name:"The Mentor",traits:["empathetic","logical","calm"],description:"Wise guide and advisor"},{name:"The Rebel",traits:["adventurous","playful","witty"],description:"Free-spirited troublemaker"},{name:"The Seductress",traits:["flirty","mysterious","dominant"],description:"Alluring enchantress"},{name:"The Artist",traits:["creative","empathetic","playful"],description:"Passionate creative soul"}];function Xt({modalId:e,onClose:t}){const{createCharacter:r}=Vt(),{startConversation:n}=qt(),i=Wt(),[o,l]=a.useState({name:"",bio:"",avatar:"",personality:""}),[c,d]=a.useState([]),[u,h]=a.useState(null),[m,p]=a.useState(!1),[g,y]=a.useState(!1),[x,v]=a.useState(!1),f=a.useRef(null);a.useEffect(()=>{const e=f.current;if(!e)return;const t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;const a=[];class s{constructor(){this.x=Math.random()*e.width,this.y=Math.random()*e.height,this.vx=.5*(Math.random()-.5),this.vy=.5*(Math.random()-.5),this.radius=2*Math.random()+1}update(){this.x+=this.vx,this.y+=this.vy,(this.x<0||this.x>e.width)&&(this.vx*=-1),(this.y<0||this.y>e.height)&&(this.vy*=-1)}draw(){t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fillStyle="rgba(139, 92, 246, 0.6)",t.fill()}}for(let r=0;r<50;r++)a.push(new s);!function s(){t.clearRect(0,0,e.width,e.height),a.forEach((e,s)=>{e.update(),e.draw(),a.slice(s+1).forEach(a=>{const s=e.x-a.x,r=e.y-a.y,n=Math.sqrt(s*s+r*r);n<150&&(t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(a.x,a.y),t.strokeStyle=`rgba(139, 92, 246, ${.2*(1-n/150)})`,t.lineWidth=.5,t.stroke())})}),requestAnimationFrame(s)}()},[]);const j=e=>{const{name:t,value:a}=e.target;l(e=>({...e,[t]:a}))},b=()=>{y(!0),setTimeout(()=>{t(),y(!1)},300)};return s.jsx("div",{className:"modal-overlay neural-builder-overlay "+(g?"closing":""),onClick:b,children:s.jsx("div",{className:"modal-content neural-builder",onClick:e=>e.stopPropagation(),children:s.jsxs(Ht,{children:[s.jsx("canvas",{ref:f,className:"neural-canvas"}),s.jsxs("div",{className:"neural-header",children:[s.jsxs("div",{className:"header-content",children:[s.jsxs("h2",{className:"neural-title",children:[s.jsx("span",{className:"title-icon",children:"🧬"}),"Neural Character Builder"]}),s.jsx("p",{className:"neural-subtitle",children:"Design your perfect AI companion"})]}),s.jsx("button",{className:"neural-close",onClick:b,children:"✕"})]}),s.jsxs("div",{className:"neural-content",children:[s.jsxs("div",{className:"neural-panel info-panel glass-panel",children:[s.jsx("h3",{className:"panel-title",children:"Character Identity"}),s.jsxs("div",{className:"form-group neural-input-group",children:[s.jsx("label",{children:"Name *"}),s.jsx("input",{type:"text",name:"name",placeholder:"Enter character name...",value:o.name,onChange:j,disabled:m,className:"neural-input",autoFocus:!0})]}),s.jsxs("div",{className:"form-group neural-input-group",children:[s.jsx("label",{children:"Avatar URL"}),s.jsx("input",{type:"url",name:"avatar",placeholder:"https://...",value:o.avatar,onChange:j,disabled:m,className:"neural-input"})]}),s.jsxs("div",{className:"form-group neural-input-group",children:[s.jsx("label",{children:"Biography"}),s.jsx("textarea",{name:"bio",placeholder:"Describe your character's background...",value:o.bio,onChange:j,disabled:m,rows:4,className:"neural-input"})]}),s.jsxs("button",{type:"button",className:"advanced-toggle",onClick:()=>v(!x),children:[x?"▼":"▶"," Advanced Options"]}),x&&s.jsxs("div",{className:"form-group neural-input-group",children:[s.jsx("label",{children:"Custom Personality (Optional)"}),s.jsx("textarea",{name:"personality",placeholder:"Override with custom personality description...",value:o.personality,onChange:j,disabled:m,rows:3,className:"neural-input"})]})]}),s.jsxs("div",{className:"neural-panel network-panel glass-panel",children:[s.jsx("h3",{className:"panel-title",children:"Personality Matrix"}),s.jsxs("div",{className:"archetypes-section",children:[s.jsx("label",{className:"section-label",children:"Quick Start Archetypes"}),s.jsx("div",{className:"archetypes-grid",children:Jt.map(e=>s.jsxs("button",{type:"button",className:"archetype-card "+(u===e.name?"active":""),onClick:()=>(e=>{h(e.name),d(e.traits),i.info(`Applied ${e.name} archetype`)})(e),disabled:m,children:[s.jsx("div",{className:"archetype-name",children:e.name}),s.jsx("div",{className:"archetype-desc",children:e.description})]},e.name))})]}),s.jsxs("div",{className:"traits-section",children:[s.jsxs("label",{className:"section-label",children:["Build Custom Traits",c.length>0&&s.jsxs("span",{className:"trait-count",children:["(",c.length," selected)"]})]}),s.jsx("div",{className:"traits-grid",children:Yt.map(e=>{const t=c.includes(e.id);return s.jsxs("button",{type:"button",className:"trait-node "+(t?"selected":""),onClick:()=>{return t=e.id,d(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]),void h(null);var t},disabled:m,style:{"--trait-color":e.color,"--trait-glow":t?`${e.color}80`:"transparent"},children:[s.jsx("span",{className:"trait-emoji",children:e.emoji}),s.jsx("span",{className:"trait-label",children:e.label}),t&&s.jsx("span",{className:"trait-check",children:"✓"})]},e.id)})})]})]}),s.jsxs("div",{className:"neural-panel preview-panel glass-panel",children:[s.jsx("h3",{className:"panel-title",children:"Character Preview"}),s.jsxs("div",{className:"character-preview-card",children:[s.jsx("div",{className:"preview-avatar",children:o.avatar?s.jsx("img",{src:o.avatar,alt:"Avatar",onError:e=>e.target.src="/assets/default-avatar.png"}):s.jsx("div",{className:"avatar-placeholder",children:s.jsx("span",{children:"👤"})})}),s.jsxs("div",{className:"preview-info",children:[s.jsx("h4",{className:"preview-name",children:o.name||"Unnamed Character"}),c.length>0&&s.jsx("div",{className:"preview-traits",children:c.map(e=>{const t=Yt.find(t=>t.id===e);return t?s.jsxs("span",{className:"preview-trait",style:{background:`${t.color}20`,color:t.color},children:[t.emoji," ",t.label]},e):null})}),o.bio&&s.jsxs("div",{className:"preview-bio",children:[s.jsx("label",{children:"Bio:"}),s.jsxs("p",{children:[o.bio.substring(0,100),o.bio.length>100?"...":""]})]}),u&&s.jsx("div",{className:"preview-archetype",children:s.jsxs("span",{className:"archetype-badge",children:["✨ ",u]})})]}),s.jsxs("div",{className:"preview-stats",children:[s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-label",children:"Traits"}),s.jsxs("span",{className:"stat-value",children:[c.length,"/12"]})]}),s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-label",children:"Complexity"}),s.jsx("span",{className:"stat-value",children:c.length<3?"Simple":c.length<6?"Moderate":"Complex"})]})]})]})]})]}),s.jsxs("div",{className:"neural-footer",children:[s.jsx("button",{type:"button",className:"neural-btn secondary",onClick:b,disabled:m,children:"Cancel"}),s.jsx("button",{type:"button",className:"neural-btn primary",onClick:async e=>{if(e.preventDefault(),o.name.trim())if(0!==c.length){p(!0);try{const e=c.map(e=>{var t;return null==(t=Yt.find(t=>t.id===e))?void 0:t.label}).filter(Boolean).join(", "),a=o.personality||`A ${e.toLowerCase()} character with unique personality traits`,s={...o,personality:a,traits:c},u=await r(s);i.success(`✨ ${o.name} has been created!`);try{await n(u.id)}catch(t){console.error("Failed to start conversation:",t),i.warning("Character created, but failed to start conversation.")}b(),l({name:"",bio:"",avatar:"",personality:""}),d([]),h(null)}catch(a){console.error("Character creation error:",a),i.error(a.message||"Failed to create character")}finally{p(!1)}}else i.warning("Select at least one personality trait");else i.warning("Character name is required")},disabled:m||!o.name.trim()||0===c.length,children:m?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"btn-spinner",children:"⚡"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"btn-icon",children:"✨"}),"Create Character"]})})]})]})})})}const Qt=async()=>{try{return await T.get("/stripe-config")}catch(e){throw console.error("Failed to fetch Stripe config:",e),e}},Zt=async(e,t)=>{try{return await T.post("/stripe-checkout",{priceId:e,email:t,successUrl:`${window.location.origin}/chat?premium=success`,cancelUrl:`${window.location.origin}/chat?premium=cancelled`})}catch(a){throw console.error("Failed to create checkout session:",a),a}},Kt=async()=>{try{return await T.get("/stripe-config")}catch(e){throw console.error("Failed to fetch Stripe config:",e),e}},ea=async(e,t)=>{try{const{url:a}=await(async(e,t)=>{try{return await T.post("/create-checkout-session",{priceId:e,userId:t})}catch(a){throw console.error("Failed to create checkout session:",a),a}})(e,t);window.location.href=a}catch(a){throw console.error("Failed to redirect to checkout:",a),a}},ta=async(e,t)=>{try{const a=await Kt();if(!a.available)throw new Error("Payment processing is currently unavailable");let s;switch(e){case"monthly":s=a.priceMonthly;break;case"yearly":s=a.priceYearly;break;case"lifetime":s=a.priceLifetime;break;default:throw new Error(`Invalid plan: ${e}`)}if(!s)throw new Error(`Price ID not configured for plan: ${e}`);await ea(s,t)}catch(a){throw console.error("Failed to create subscription:",a),a}};function aa({modalId:e,onClose:t}){var r;const{user:n,updateProfile:i}=V(),{characters:o,deleteCharacterData:l,updateCharacterData:c}=Vt(),{conversations:d}=qt(),u=Wt(),[h,m]=a.useState("account"),[p,g]=a.useState(!1),[y,x]=a.useState(null),[v,f]=a.useState(null),j=null!=(r=null==n?void 0:n.isPremium)&&r,[b,N]=a.useState({theme:"dark",notifications:!0,autoSave:!0,experimentalFeatures:!1,temperature:.7,maxTokens:2048,modelType:"default",fontSize:"medium",showTimestamps:!0,enableTypingIndicator:!0,autoScroll:!0,messageGrouping:!0}),C=(e,t)=>{N("boolean"==typeof t||void 0===t?t=>({...t,[e]:!t[e]}):a=>({...a,[e]:t}))};return s.jsx("div",{className:"modal-overlay",onClick:t,children:s.jsxs("div",{className:"modal-content settings-modal",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Settings"}),s.jsx("button",{className:"modal-close",onClick:t,children:"✕"})]}),s.jsxs("div",{className:"settings-container",children:[s.jsxs("div",{className:"settings-sidebar",children:[s.jsx("button",{className:"settings-tab "+("account"===h?"active":""),onClick:()=>m("account"),children:"👤 Account"}),s.jsx("button",{className:"settings-tab "+("characters"===h?"active":""),onClick:()=>m("characters"),children:"🎭 Characters"}),s.jsx("button",{className:"settings-tab "+("ai-settings"===h?"active":""),onClick:()=>m("ai-settings"),children:"🤖 AI Settings"}),s.jsx("button",{className:"settings-tab "+("chat-settings"===h?"active":""),onClick:()=>m("chat-settings"),children:"💬 Chat"}),s.jsx("button",{className:"settings-tab "+("preferences"===h?"active":""),onClick:()=>m("preferences"),children:"⚙️ Preferences"}),s.jsx("button",{className:"settings-tab "+("data"===h?"active":""),onClick:()=>m("data"),children:"📊 Data & Privacy"}),s.jsx("button",{className:"settings-tab "+("premium"===h?"active":""),onClick:()=>m("premium"),children:"✨ Premium"})]}),s.jsxs("div",{className:"settings-content",children:["account"===h&&s.jsxs("div",{className:"settings-section",children:[s.jsx("h3",{children:"Account Settings"}),s.jsx("div",{className:"setting-item",children:s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Email"}),s.jsx("p",{className:"setting-value",children:(null==n?void 0:n.email)||"Not set"})]})}),s.jsx("div",{className:"setting-item",children:s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Account Status"}),s.jsx("p",{className:"setting-value",children:j?s.jsx("span",{className:"status-premium",children:"✨ Premium"}):s.jsx("span",{className:"status-free",children:"Free"})})]})}),s.jsxs("div",{className:"setting-item",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Password"}),s.jsx("p",{className:"setting-value",children:"••••••••"})]}),s.jsx("button",{className:"btn-text",children:"Change"})]}),s.jsx("div",{className:"setting-item",children:s.jsx("button",{className:"btn-secondary full-width",children:"Logout"})})]}),"preferences"===h&&s.jsxs("div",{className:"settings-section",children:[s.jsx("h3",{children:"Preferences"}),s.jsxs("div",{className:"setting-item toggle",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Notifications"}),s.jsx("p",{className:"setting-description",children:"Get notified about new messages"})]}),s.jsxs("label",{className:"toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:b.notifications,onChange:()=>C("notifications")}),s.jsx("span",{className:"toggle-slider"})]})]}),s.jsxs("div",{className:"setting-item toggle",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Auto-Save"}),s.jsx("p",{className:"setting-description",children:"Automatically save conversations"})]}),s.jsxs("label",{className:"toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:b.autoSave,onChange:()=>C("autoSave")}),s.jsx("span",{className:"toggle-slider"})]})]}),s.jsxs("div",{className:"setting-item toggle",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Experimental Features"}),s.jsx("p",{className:"setting-description",children:"Try beta features early"})]}),s.jsxs("label",{className:"toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:b.experimentalFeatures,onChange:()=>C("experimentalFeatures")}),s.jsx("span",{className:"toggle-slider"})]})]})]}),"characters"===h&&s.jsxs("div",{className:"settings-section",children:[s.jsx("h3",{children:"Manage Characters"}),s.jsx("p",{className:"section-description",children:"Edit or delete your custom AI characters"}),0===o.length?s.jsxs("div",{className:"empty-state",children:[s.jsx("p",{children:"No custom characters yet"}),s.jsx("p",{className:"text-sm",children:"Create your first character to get started!"})]}):s.jsx("div",{className:"character-list",children:o.map(e=>{var t;return s.jsxs("div",{className:"character-item",children:[s.jsx("div",{className:"character-avatar",children:e.avatar||"🎭"}),s.jsxs("div",{className:"character-info",children:[s.jsx("p",{className:"character-name",children:e.name}),s.jsxs("p",{className:"character-bio",children:[null==(t=e.bio)?void 0:t.substring(0,50),"..."]})]}),s.jsxs("div",{className:"character-actions",children:[s.jsx("button",{className:"btn-icon",onClick:()=>(e=>{x({...e})})(e),title:"Edit character",children:"✏️"}),s.jsx("button",{className:"btn-icon danger",onClick:()=>f(e.id),title:"Delete character",children:"🗑️"})]})]},e.id)})}),y&&s.jsxs("div",{className:"inline-modal",children:[s.jsx("h4",{children:"Edit Character"}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Name"}),s.jsx("input",{type:"text",value:y.name,onChange:e=>x({...y,name:e.target.value})})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Bio"}),s.jsx("textarea",{value:y.bio,onChange:e=>x({...y,bio:e.target.value}),rows:3})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Personality"}),s.jsx("textarea",{value:y.personality,onChange:e=>x({...y,personality:e.target.value}),rows:2})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>x(null),children:"Cancel"}),s.jsx("button",{className:"btn-primary",onClick:async()=>{if(y)try{await c(y.id,{name:y.name,bio:y.bio,personality:y.personality,avatar:y.avatar}),u.success("Character updated successfully!"),x(null)}catch(e){u.error("Failed to update character: "+e.message)}},children:"Save Changes"})]})]}),v&&s.jsxs("div",{className:"inline-modal danger",children:[s.jsx("h4",{children:"⚠️ Delete Character?"}),s.jsx("p",{children:"This will permanently delete this character and all associated conversations. This cannot be undone."}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>f(null),children:"Cancel"}),s.jsx("button",{className:"btn-danger",onClick:()=>(async e=>{try{await l(e),u.success("Character deleted successfully"),f(null)}catch(t){u.error("Failed to delete character: "+t.message)}})(v),children:"Delete Permanently"})]})]})]}),"ai-settings"===h&&s.jsxs("div",{className:"settings-section",children:[s.jsx("h3",{children:"AI Model Settings"}),s.jsx("p",{className:"section-description",children:"Customize AI behavior and response generation"}),s.jsxs("div",{className:"setting-item",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Model Type"}),s.jsx("p",{className:"setting-description",children:"Choose the AI model for conversations"})]}),s.jsxs("select",{value:b.modelType,onChange:e=>C("modelType",e.target.value),className:"setting-select",children:[s.jsx("option",{value:"default",children:"Default (GPT-4)"}),s.jsx("option",{value:"fast",children:"Fast (GPT-3.5 Turbo)"}),s.jsx("option",{value:"creative",children:"Creative (Higher Temperature)"})]})]}),s.jsxs("div",{className:"setting-item",children:[s.jsxs("div",{className:"setting-info",children:[s.jsxs("p",{className:"setting-label",children:["Temperature: ",b.temperature]}),s.jsx("p",{className:"setting-description",children:"Controls randomness (0 = focused, 1 = creative)"})]}),s.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:b.temperature,onChange:e=>C("temperature",parseFloat(e.target.value)),className:"setting-slider"})]}),s.jsxs("div",{className:"setting-item",children:[s.jsxs("div",{className:"setting-info",children:[s.jsxs("p",{className:"setting-label",children:["Max Response Length: ",b.maxTokens," tokens"]}),s.jsx("p",{className:"setting-description",children:"Maximum length of AI responses"})]}),s.jsx("input",{type:"range",min:"256",max:"4096",step:"256",value:b.maxTokens,onChange:e=>C("maxTokens",parseInt(e.target.value)),className:"setting-slider"})]})]}),"chat-settings"===h&&s.jsxs("div",{className:"settings-section",children:[s.jsx("h3",{children:"Chat Display Settings"}),s.jsx("p",{className:"section-description",children:"Customize how conversations are displayed"}),s.jsxs("div",{className:"setting-item",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Font Size"}),s.jsx("p",{className:"setting-description",children:"Adjust message text size"})]}),s.jsxs("select",{value:b.fontSize,onChange:e=>C("fontSize",e.target.value),className:"setting-select",children:[s.jsx("option",{value:"small",children:"Small"}),s.jsx("option",{value:"medium",children:"Medium"}),s.jsx("option",{value:"large",children:"Large"})]})]}),s.jsxs("div",{className:"setting-item toggle",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Show Timestamps"}),s.jsx("p",{className:"setting-description",children:"Display time for each message"})]}),s.jsxs("label",{className:"toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:b.showTimestamps,onChange:()=>C("showTimestamps")}),s.jsx("span",{className:"toggle-slider"})]})]}),s.jsxs("div",{className:"setting-item toggle",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Typing Indicator"}),s.jsx("p",{className:"setting-description",children:"Show when AI is typing"})]}),s.jsxs("label",{className:"toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:b.enableTypingIndicator,onChange:()=>C("enableTypingIndicator")}),s.jsx("span",{className:"toggle-slider"})]})]}),s.jsxs("div",{className:"setting-item toggle",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Auto-scroll"}),s.jsx("p",{className:"setting-description",children:"Automatically scroll to new messages"})]}),s.jsxs("label",{className:"toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:b.autoScroll,onChange:()=>C("autoScroll")}),s.jsx("span",{className:"toggle-slider"})]})]}),s.jsxs("div",{className:"setting-item toggle",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Group Messages"}),s.jsx("p",{className:"setting-description",children:"Group consecutive messages from same sender"})]}),s.jsxs("label",{className:"toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:b.messageGrouping,onChange:()=>C("messageGrouping")}),s.jsx("span",{className:"toggle-slider"})]})]})]}),"data"===h&&s.jsxs("div",{className:"settings-section",children:[s.jsx("h3",{children:"Data & Privacy"}),s.jsx("p",{className:"section-description",children:"Manage your data and privacy settings"}),s.jsxs("div",{className:"setting-item",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Export Conversations"}),s.jsx("p",{className:"setting-description",children:"Download all your conversations as JSON"})]}),s.jsx("button",{className:"btn-secondary",onClick:()=>{try{const e=JSON.stringify(d,null,2),t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`justlayme-conversations-${(new Date).toISOString().split("T")[0]}.json`,s.click(),URL.revokeObjectURL(a),u.success("Conversations exported successfully!")}catch(e){u.error("Failed to export conversations: "+e.message)}},children:"📥 Export Data"})]}),s.jsx("div",{className:"setting-item",children:s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Conversation Statistics"}),s.jsxs("p",{className:"setting-description",children:["Total conversations: ",d.length]})]})}),s.jsx("div",{className:"setting-item",children:s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label",children:"Character Statistics"}),s.jsxs("p",{className:"setting-description",children:["Total characters: ",o.length]})]})}),s.jsx("div",{className:"setting-item danger-zone",children:s.jsxs("div",{className:"setting-info",children:[s.jsx("p",{className:"setting-label danger",children:"⚠️ Danger Zone"}),s.jsx("p",{className:"setting-description",children:"Irreversible actions - use with caution"})]})}),s.jsx("div",{className:"setting-item",children:s.jsx("button",{className:"btn-danger full-width",onClick:()=>{confirm("Are you sure you want to delete your account? This cannot be undone.")&&u.error("Account deletion is not yet implemented")},children:"Delete Account"})})]}),"premium"===h&&s.jsx("div",{className:"settings-section premium-section",children:j?s.jsxs(s.Fragment,{children:[s.jsx("h3",{children:"Premium Active"}),s.jsxs("div",{className:"premium-status",children:[s.jsx("p",{className:"status-message",children:"✨ You have access to all premium features!"}),s.jsx("p",{className:"renewal-info",children:"Your subscription renews on December 13, 2025"})]}),s.jsx("button",{className:"btn-secondary full-width",children:"Manage Subscription"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{children:"Unlock Premium"}),s.jsx("p",{className:"premium-description",children:"Get exclusive features and unlimited access to all AI characters."}),s.jsxs("div",{className:"premium-features",children:[s.jsxs("div",{className:"feature-item",children:[s.jsx("span",{className:"feature-icon",children:"♾️"}),s.jsxs("div",{className:"feature-text",children:[s.jsx("p",{className:"feature-name",children:"Unlimited Conversations"}),s.jsx("p",{className:"feature-desc",children:"Chat with any character anytime"})]})]}),s.jsxs("div",{className:"feature-item",children:[s.jsx("span",{className:"feature-icon",children:"🔊"}),s.jsxs("div",{className:"feature-text",children:[s.jsx("p",{className:"feature-name",children:"Voice Cloning"}),s.jsx("p",{className:"feature-desc",children:"Clone your voice for natural interactions"})]})]}),s.jsxs("div",{className:"feature-item",children:[s.jsx("span",{className:"feature-icon",children:"🎭"}),s.jsxs("div",{className:"feature-text",children:[s.jsx("p",{className:"feature-name",children:"Unlimited Characters"}),s.jsx("p",{className:"feature-desc",children:"Create and customize unlimited AI personas"})]})]}),s.jsxs("div",{className:"feature-item",children:[s.jsx("span",{className:"feature-icon",children:"🪞"}),s.jsxs("div",{className:"feature-text",children:[s.jsx("p",{className:"feature-name",children:"The Grey Mirror Pro"}),s.jsx("p",{className:"feature-desc",children:"Advanced relationship analysis with insights"})]})]}),s.jsxs("div",{className:"feature-item",children:[s.jsx("span",{className:"feature-icon",children:"⚡"}),s.jsxs("div",{className:"feature-text",children:[s.jsx("p",{className:"feature-name",children:"Priority Support"}),s.jsx("p",{className:"feature-desc",children:"Get help from our support team"})]})]})]}),s.jsxs("div",{className:"pricing-card",children:[s.jsxs("div",{className:"price",children:["$9.99",s.jsx("span",{children:"/month"})]}),s.jsx("button",{className:"btn-primary full-width",onClick:async()=>{g(!0);try{(await ta("price_monthly_premium")).clientSecret&&(u.success("Subscription created! Redirecting to payment..."),setTimeout(()=>{i({isPremium:!0}),u.success("✨ Welcome to Premium!"),m("premium")},2e3))}catch(e){u.error("Failed to process subscription: "+(e.message||"Unknown error"))}finally{g(!1)}},disabled:p,children:p?"Processing...":"Upgrade to Premium"}),s.jsx("p",{className:"pricing-note",children:"Cancel anytime. No hidden fees."})]})]})})]})]})]})})}function sa({modalId:e,onClose:t,feature:r="this premium feature"}){const{user:n}=V(),[i,o]=a.useState(!1),[l,c]=a.useState(null),[d,u]=a.useState("");a.useEffect(()=>{h()},[]);const h=async()=>{try{const e=await Qt();c(e.prices)}catch(e){console.error("Failed to load pricing:",e),u("Failed to load pricing information")}},m=async(e,t)=>{o(!0),u("");try{if(!n||!n.email)return u("Please log in to upgrade to premium"),void o(!1);const{url:t}=await Zt(e,n.email);window.location.href=t}catch(a){console.error("Checkout failed:",a),u(a.message||"Failed to start checkout. Please try again."),o(!1)}};return s.jsx("div",{className:"modal-overlay",onClick:t,children:s.jsxs("div",{className:"premium-paywall-modal",onClick:e=>e.stopPropagation(),children:[s.jsx("button",{className:"modal-close",onClick:t,"aria-label":"Close modal",children:"✕"}),s.jsxs("div",{className:"paywall-header",children:[s.jsx("div",{className:"premium-badge",children:"Premium"}),s.jsx("h2",{children:"Unlock Full Access"}),s.jsxs("p",{className:"feature-unlock",children:["Get ",r," and all premium features"]}),n&&n.email&&s.jsx("p",{className:"user-info",children:n.email})]}),s.jsxs("div",{className:"trust-indicators",children:[s.jsxs("div",{className:"trust-badge",children:[s.jsx("span",{className:"icon",children:"🔒"}),s.jsx("span",{className:"text",children:"Secure Payment"})]}),s.jsxs("div",{className:"trust-badge",children:[s.jsx("span",{className:"icon",children:"⚡"}),s.jsx("span",{className:"text",children:"Instant Access"})]}),s.jsxs("div",{className:"trust-badge",children:[s.jsx("span",{className:"icon",children:"↩️"}),s.jsx("span",{className:"text",children:"Cancel Anytime"})]})]}),d&&s.jsxs("div",{className:"error-message",children:[s.jsx("span",{className:"error-icon",children:"⚠️"}),s.jsx("span",{children:d})]}),l&&l.monthly&&l.yearly&&l.lifetime&&s.jsxs("div",{className:"pricing-tiers",children:[l.monthly&&s.jsxs("div",{className:"pricing-card",children:[s.jsx("div",{className:"plan-badge",children:"Most Flexible"}),s.jsx("h3",{children:"Monthly"}),s.jsxs("div",{className:"price",children:[s.jsxs("span",{className:"amount",children:["$",(l.monthly.amount/100).toFixed(2)]}),s.jsx("span",{className:"period",children:"/month"})]}),s.jsxs("ul",{className:"features",children:[s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," Unlimited conversations"]}),s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," All character features"]}),s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," The Grey Mirror analysis"]}),s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," Priority support"]})]}),s.jsx("button",{className:"btn-upgrade",onClick:()=>m(l.monthly.id),disabled:i,"aria-label":"Subscribe to Monthly Plan",children:i?"Redirecting...":"Start Monthly Plan"})]}),l.yearly&&s.jsxs("div",{className:"pricing-card featured",children:[s.jsx("div",{className:"plan-badge",children:"Best Value - Save 20%"}),s.jsx("h3",{children:"Yearly"}),s.jsxs("div",{className:"price",children:[s.jsxs("span",{className:"amount",children:["$",(l.yearly.amount/100).toFixed(2)]}),s.jsx("span",{className:"period",children:"/year"})]}),s.jsx("div",{className:"savings",children:"2 months free compared to monthly"}),s.jsxs("ul",{className:"features",children:[s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," Everything in Monthly"]}),s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," 2 months free"]}),s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," Early access to features"]}),s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," Premium badge"]})]}),s.jsx("button",{className:"btn-upgrade primary",onClick:()=>m(l.yearly.id),disabled:i,"aria-label":"Subscribe to Yearly Plan",children:i?"Redirecting...":"Get Best Value"})]}),l.lifetime&&s.jsxs("div",{className:"pricing-card",children:[s.jsx("div",{className:"plan-badge",children:"One-Time Payment"}),s.jsx("h3",{children:"Lifetime"}),s.jsxs("div",{className:"price",children:[s.jsxs("span",{className:"amount",children:["$",(l.lifetime.amount/100).toFixed(2)]}),s.jsx("span",{className:"period",children:"once"})]}),s.jsxs("ul",{className:"features",children:[s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," Everything in Yearly"]}),s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," Pay once, access forever"]}),s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," Lifetime updates"]}),s.jsxs("li",{children:[s.jsx("span",{className:"check",children:"✓"})," Founding member status"]})]}),s.jsx("button",{className:"btn-upgrade",onClick:()=>m(l.lifetime.id),disabled:i,"aria-label":"Get Lifetime Access",children:i?"Redirecting...":"Get Lifetime Access"})]})]}),!l&&!d&&s.jsxs("div",{className:"loading-pricing",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:"Loading pricing..."})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsxs("div",{className:"powered-by",children:[s.jsx("span",{className:"lock-icon",children:"🔒"}),s.jsx("span",{children:"Powered by Stripe - Industry-leading security"})]}),s.jsx("p",{className:"money-back",children:"30-day money-back guarantee"})]})]})})}function ra(){const{modalStack:e,closeModal:t}=a.useContext(q);if(!e||0===e.length)return null;return s.jsx(s.Fragment,{children:e.map(e=>{switch(e.type){case"character-creator":return s.jsx(Xt,{modalId:e.id,onClose:()=>t(e.id)},e.id);case"settings":return s.jsx(aa,{modalId:e.id,onClose:()=>t(e.id)},e.id);case"premium-paywall":return s.jsx(sa,{modalId:e.id,onClose:()=>t(e.id),feature:e.feature||"this premium feature"},e.id);default:return null}})})}const na=({targetSelector:e='.cursor-target, button, a, [role="button"], .btn, .action-btn, .footer-btn, .close-btn, .sidebar-toggle, input[type="submit"], input[type="button"]',spinDuration:t=2,hideDefaultCursor:r=!0,hoverDuration:n=.2,parallaxOn:i=!0})=>{const o=a.useRef(null),l=a.useRef(null),c=a.useRef(null),d=a.useRef(null),u=a.useRef(!1),h=a.useRef(null),m=a.useRef(null),p=a.useRef(0),g=a.useMemo(()=>{const e="ontouchstart"in window||navigator.maxTouchPoints>0,t=window.innerWidth<=768,a=navigator.userAgent||navigator.vendor||window.opera,s=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(a.toLowerCase());return e&&t||s},[]),y=a.useMemo(()=>({borderWidth:3,cornerSize:12}),[]),x=a.useCallback((e,t)=>{o.current&&C.to(o.current,{x:e,y:t,duration:.1,ease:"power3.out"})},[]);return a.useEffect(()=>{if(g||!o.current)return;const a=document.body.style.cursor;if(r){const e=document.createElement("style");e.id="target-cursor-hide",e.textContent='\n        body, html {\n          cursor: none !important;\n        }\n        /* Show default cursor on inputs and textareas for better UX */\n        input, textarea, select, button {\n          cursor: auto !important;\n        }\n        /* Show default cursor on modals and overlays */\n        [role="dialog"], [class*="modal"], [class*="overlay"] {\n          cursor: auto !important;\n        }\n        /* Show default cursor on Dock elements */\n        [class*="dock"], .dock-item, .dock-panel, .dock-outer {\n          cursor: pointer !important;\n        }\n        /* Show default cursor on interactive elements */\n        a, [role="button"], [tabindex] {\n          cursor: pointer !important;\n        }\n      ',document.head.appendChild(e)}const s=o.current;l.current=s.querySelectorAll(".target-cursor-corner");let v=null,f=null,j=null;const b=e=>{f&&e.removeEventListener("mouseleave",f),f=null};C.set(s,{xPercent:-50,yPercent:-50,x:window.innerWidth/2,y:window.innerHeight/2});c.current&&c.current.kill(),c.current=C.timeline({repeat:-1}).to(s,{rotation:"+=360",duration:t,ease:"none"});m.current=()=>{if(!h.current||!o.current||!l.current)return;const e=p.current;if(0===e)return;const t=C.getProperty(o.current,"x"),a=C.getProperty(o.current,"y");Array.from(l.current).forEach((s,r)=>{const n=C.getProperty(s,"x"),o=C.getProperty(s,"y"),l=h.current[r].x-t,c=h.current[r].y-a,d=n+(l-n)*e,u=o+(c-o)*e,m=e>=.99?i?.2:0:.05;C.to(s,{x:d,y:u,duration:m,ease:0===m?"none":"power1.out",overwrite:"auto"})})};const N=e=>x(e.clientX,e.clientY);window.addEventListener("mousemove",N);const w=()=>{if(!v||!o.current)return;const t=C.getProperty(o.current,"x"),a=C.getProperty(o.current,"y"),s=document.elementFromPoint(t,a);s&&(s===v||s.closest(e)===v)||f&&f()};window.addEventListener("scroll",w,{passive:!0});const E=()=>{d.current&&(C.to(d.current,{scale:.7,duration:.3}),C.to(o.current,{scale:.9,duration:.2}))},S=()=>{d.current&&(C.to(d.current,{scale:1,duration:.3}),C.to(o.current,{scale:1,duration:.2}))};window.addEventListener("mousedown",E),window.addEventListener("mouseup",S);const k=a=>{var s;const r=[];let i=a.target;for(;i&&i!==document.body;)i.matches(e)&&r.push(i),i=i.parentElement;const d=r[0]||null;if(!d||!o.current||!l.current)return;if(v===d)return;v&&b(v),j&&(clearTimeout(j),j=null),v=d;const g=Array.from(l.current);g.forEach(e=>C.killTweensOf(e)),C.killTweensOf(o.current,"rotation"),null==(s=c.current)||s.pause(),C.set(o.current,{rotation:0}),o.current&&o.current.classList.add("active");const x=d.getBoundingClientRect(),{borderWidth:N,cornerSize:w}=y,E=C.getProperty(o.current,"x"),S=C.getProperty(o.current,"y");h.current=[{x:x.left-N,y:x.top-N},{x:x.right+N-w,y:x.top-N},{x:x.right+N-w,y:x.bottom+N-w},{x:x.left-N,y:x.bottom+N-w}],u.current=!0,C.ticker.add(m.current),C.to(p,{current:1,duration:n,ease:"power2.out"}),g.forEach((e,t)=>{C.to(e,{x:h.current[t].x-E,y:h.current[t].y-S,duration:.2,ease:"power2.out"})});const k=()=>{if(C.ticker.remove(m.current),o.current&&o.current.classList.remove("active"),u.current=!1,h.current=null,C.set(p,{current:0,overwrite:!0}),v=null,l.current){const e=Array.from(l.current);C.killTweensOf(e);const{cornerSize:t}=y,a=[{x:1.5*-t,y:1.5*-t},{x:.5*t,y:1.5*-t},{x:.5*t,y:.5*t},{x:1.5*-t,y:.5*t}],s=C.timeline();e.forEach((e,t)=>{s.to(e,{x:a[t].x,y:a[t].y,duration:.3,ease:"power3.out"},0)})}j=setTimeout(()=>{if(!v&&o.current&&c.current){const e=C.getProperty(o.current,"rotation")%360;c.current.kill(),c.current=C.timeline({repeat:-1}).to(o.current,{rotation:"+=360",duration:t,ease:"none"}),C.to(o.current,{rotation:e+360,duration:t*(1-e/360),ease:"none",onComplete:()=>{var e;null==(e=c.current)||e.restart()}})}j=null},50),b(d)};f=k,d.addEventListener("mouseleave",k)};return window.addEventListener("mouseover",k,{passive:!0}),()=>{var e;m.current&&C.ticker.remove(m.current),window.removeEventListener("mousemove",N),window.removeEventListener("mouseover",k),window.removeEventListener("scroll",w),window.removeEventListener("mousedown",E),window.removeEventListener("mouseup",S),v&&b(v),null==(e=c.current)||e.kill(),document.body.style.cursor=a;const t=document.getElementById("target-cursor-hide");t&&t.remove(),u.current=!1,h.current=null,p.current=0}},[e,t,x,y,r,g,n,i]),a.useEffect(()=>{!g&&o.current&&c.current&&c.current.isActive()&&(c.current.kill(),c.current=C.timeline({repeat:-1}).to(o.current,{rotation:"+=360",duration:t,ease:"none"}))},[t,g]),g?null:s.jsxs("div",{ref:o,className:"target-cursor-wrapper",children:[s.jsx("div",{ref:d,className:"target-cursor-dot"}),s.jsx("div",{className:"target-cursor-corner corner-tl"}),s.jsx("div",{className:"target-cursor-corner corner-tr"}),s.jsx("div",{className:"target-cursor-corner corner-br"}),s.jsx("div",{className:"target-cursor-corner corner-bl"})]})},ia=a.lazy(()=>m(()=>import("./ChatPage-CSkd91X2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),oa=a.lazy(()=>m(()=>import("./BlackMirrorPage-v7ZP0Qwx.js"),__vite__mapDeps([10,1,2,11,3,4,5,6,7,8,12]))),la=a.lazy(()=>m(()=>import("./PremiumPage-D7jmUDgA.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,8,14]))),ca=a.lazy(()=>m(()=>import("./NotFoundPage-DqH19mUl.js"),__vite__mapDeps([15,1,2,3,4,5,6,7,8,16]))),da=a.lazy(()=>m(()=>import("./VerifyEmailPage-7hBDg8h6.js"),__vite__mapDeps([17,1,2,3,4,5,6,7,8,18]))),ua=a.lazy(()=>m(()=>import("./ForgotPasswordPage-k-EvJHey.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8]))),ha=a.lazy(()=>m(()=>import("./ResetPasswordPage-BKDMyTgl.js"),__vite__mapDeps([20,1,2,3,4,5,6,7,8]))),ma="1055713717592-pqb3q7d5qsh8nlhcrusf1s2ivpsg22a5.apps.googleusercontent.com";function pa(){const e=n(),t=o();a.useEffect(()=>{const e=t.pathname;((e,t="",a={})=>{if(w())try{window.gtag("config",window.gtag.measurementId||"",{page_path:e,page_title:t,...a})}catch(s){console.error("Error tracking page view:",s)}else console.debug("GA not available, skipping page view:",e)})(e,r(e))},[t.pathname]);const r=e=>new Map([["/","Home"],["/login","Login"],["/forgot-password","Forgot Password"],["/reset-password","Reset Password"],["/chat","Chat"],["/grey-mirror","The Grey Mirror Analysis"],["/premium","Premium"],["/verify-email","Email Verification"]]).get(e)||e;return a.useEffect(()=>{const t=t=>{console.warn("Session expired, redirecting to home"),e("/")};return window.addEventListener("auth:unauthorized",t),()=>window.removeEventListener("auth:unauthorized",t)},[e]),a.useEffect(()=>{localStorage.getItem("authToken")&&setTimeout(()=>{m(()=>import("./ChatPage-CSkd91X2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])),m(()=>import("./BlackMirrorPage-v7ZP0Qwx.js"),__vite__mapDeps([10,1,2,11,3,4,5,6,7,8,12]))},1e3)},[]),a.useEffect(()=>{const e=e=>{var t;console.error("[Global] Unhandled promise rejection:",e.reason),E((null==(t=e.reason)?void 0:t.message)||"Unhandled promise rejection",!1)};return window.addEventListener("unhandledrejection",e),()=>window.removeEventListener("unhandledrejection",e)},[]),s.jsx(Ae,{children:s.jsxs(c,{children:[s.jsx(d,{path:"/",element:s.jsx(we,{})}),s.jsx(d,{path:"/login",element:s.jsx(Se,{})}),s.jsx(d,{path:"/forgot-password",element:s.jsx(Ht,{children:s.jsx(a.Suspense,{fallback:s.jsx(ke,{message:"Loading..."}),children:s.jsx(ua,{})})})}),s.jsx(d,{path:"/reset-password",element:s.jsx(Ht,{children:s.jsx(a.Suspense,{fallback:s.jsx(ke,{message:"Loading..."}),children:s.jsx(ha,{})})})}),s.jsx(d,{path:"/chat",element:s.jsx(Ht,{children:s.jsx(a.Suspense,{fallback:s.jsx(ke,{message:"Loading Chat..."}),children:s.jsx(ia,{})})})}),s.jsx(d,{path:"/grey-mirror",element:s.jsx(Ht,{children:s.jsx(a.Suspense,{fallback:s.jsx(ke,{message:"Loading The Grey Mirror..."}),children:s.jsx(oa,{})})})}),s.jsx(d,{path:"/premium",element:s.jsx(Ht,{children:s.jsx(a.Suspense,{fallback:s.jsx(ke,{message:"Loading Premium..."}),children:s.jsx(la,{})})})}),s.jsx(d,{path:"/verify-email",element:s.jsx(Ht,{children:s.jsx(a.Suspense,{fallback:s.jsx(ke,{message:"Verifying Email..."}),children:s.jsx(da,{})})})}),s.jsx(d,{path:"*",element:s.jsx(Ht,{children:s.jsx(a.Suspense,{fallback:s.jsx(ke,{message:"Loading..."}),children:s.jsx(ca,{})})})})]})})}function ga(){const e=({children:e})=>""!==ma.trim()?s.jsx(p,{clientId:ma,children:e}):s.jsx(s.Fragment,{children:e});return s.jsx(e,{children:s.jsx(k,{children:s.jsx(B,{children:s.jsx(rt,{children:s.jsx(wt,{children:s.jsx(ne,{children:s.jsx(Bt,{children:s.jsxs(l,{children:[s.jsx(na,{}),s.jsx(pa,{}),s.jsx(ra,{})]})})})})})})})})}(e=>{if(!e||"G-XXXXXXXXXX"===e)return console.warn("Google Analytics not configured. Set VITE_GA_MEASUREMENT_ID environment variable with your GA4 Measurement ID."),!1;if("undefined"==typeof window)return console.warn("Google Analytics initialization attempted in non-browser environment"),!1;try{return window.dataLayer=window.dataLayer||[],void 0===window.gtag&&(window.gtag=function(){window.dataLayer.push(arguments)}),window.gtag("js",new Date),window.gtag("config",e,{allow_google_signals:!0,allow_ad_personalization_signals:!0}),console.log("Google Analytics initialized with measurement ID:",e),!0}catch(t){return console.error("Error initializing Google Analytics:",t),!1}})("G-H2MSZKQFJV"),u.createRoot(document.getElementById("root")).render(s.jsx(a.StrictMode,{children:s.jsx(h,{children:s.jsx(ga,{})})}));export{Et as B,Ht as E,je as L,Ce as M,sa as P,Ne as R,fe as S,q as U,V as a,qt as b,Vt as c,ie as d,ye as e,Wt as f,T as g,ve as h,A as u};
